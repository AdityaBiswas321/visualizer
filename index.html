<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture Visualization - Legacy vs New System</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0f;
            color: #fff;
            overflow: hidden;
        }

        #root {
            width: 100vw;
            height: 100vh;
        }

        .app {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            background: #0a0a0f;
        }

        .header {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px 30px;
            border-bottom: 1px solid rgba(102, 126, 234, 0.3);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .view-toggle {
            display: flex;
            gap: 10px;
            background: rgba(255, 255, 255, 0.05);
            padding: 5px;
            border-radius: 10px;
        }

        .view-toggle button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: transparent;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .view-toggle button:hover {
            color: #fff;
            background: rgba(255, 255, 255, 0.1);
        }

        .view-toggle button.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
        }

        .main-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .canvas-wrapper {
            width: 100%;
            height: 100%;
            position: relative;
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        .info-overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(10, 10, 15, 0.9);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 20px;
            min-width: 280px;
            max-width: 350px;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        .info-overlay h2 {
            font-size: 1.2rem;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.7);
        }

        .stat-value {
            font-weight: 600;
            color: #667eea;
        }

        .systems-list {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .systems-list h3 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.9);
        }

        .system-tag {
            display: inline-block;
            padding: 4px 10px;
            margin: 4px;
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.4);
            border-radius: 15px;
            font-size: 0.75rem;
            color: #667eea;
        }

        .legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(10, 10, 15, 0.9);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        .legend h3 {
            font-size: 1rem;
            margin-bottom: 12px;
            color: rgba(255, 255, 255, 0.9);
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.85rem;
        }

        .legend-color {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            margin-right: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .controls {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(10, 10, 15, 0.9);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            min-width: 200px;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .controls.hidden {
            opacity: 0;
            pointer-events: none;
            transform: translateX(20px);
        }

        .mobile-toggle {
            position: absolute;
            top: 80px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: rgba(102, 126, 234, 0.3);
            border: 2px solid rgba(102, 126, 234, 0.5);
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            z-index: 1000;
            backdrop-filter: blur(20px);
            transition: all 0.3s ease;
        }

        .mobile-toggle:hover {
            background: rgba(102, 126, 234, 0.5);
            transform: scale(1.05);
        }

        .controls h3 {
            font-size: 1rem;
            margin-bottom: 12px;
            color: rgba(255, 255, 255, 0.9);
        }

        .control-button {
            width: 100%;
            padding: 10px;
            margin-bottom: 8px;
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 8px;
            color: #fff;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .control-button:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.5);
            transform: translateY(-1px);
        }

        .control-button:active {
            transform: translateY(0);
        }

        .control-button.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-color: transparent;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(102, 126, 234, 0.3);
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .tooltip {
            position: fixed;
            background: rgba(10, 10, 15, 0.95);
            border: 2px solid rgba(102, 126, 234, 0.8);
            border-radius: 12px;
            padding: 15px 20px;
            pointer-events: none;
            z-index: 10000;
            max-width: 400px;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.7);
            display: none;
        }

        .tooltip.visible {
            display: block;
        }

        .tooltip h4 {
            margin-bottom: 8px;
            font-size: 1.1rem;
            color: #667eea;
            font-weight: 700;
        }

        .tooltip p {
            font-size: 0.9rem;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.9);
            margin: 6px 0;
        }

        .tooltip .detail {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
        }

        .tooltip .badge {
            display: inline-block;
            padding: 3px 8px;
            margin: 4px 4px 4px 0;
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid rgba(102, 126, 234, 0.4);
            border-radius: 12px;
            font-size: 0.75rem;
        }

        .layer-badge {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(10, 10, 15, 0.9);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px 20px;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        .layer-count {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
        }

        .layer-label {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
            text-align: center;
            margin-top: 5px;
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .mobile-toggle {
                display: flex !important;
            }

            .info-overlay.hidden,
            .legend.hidden,
            .layer-badge.hidden {
                opacity: 0;
                pointer-events: none;
                transform: translateY(20px);
            }

            .info-overlay,
            .legend,
            .layer-badge {
                transition: opacity 0.3s ease, transform 0.3s ease;
            }

            .header h1 {
                font-size: 1.1rem;
            }

            .view-toggle button {
                padding: 8px 12px;
                font-size: 0.8rem;
            }

            .info-overlay {
                top: 10px;
                left: 10px;
                padding: 12px;
                min-width: 200px;
                max-width: 250px;
                font-size: 0.85rem;
            }

            .legend {
                bottom: 10px;
                left: 10px;
                padding: 10px;
            }

            .legend h3 {
                font-size: 0.9rem;
            }

            .legend-item {
                font-size: 0.75rem;
            }

            .controls {
                top: 10px;
                right: 10px;
                padding: 10px;
                min-width: 150px;
            }

            .controls h3 {
                font-size: 0.9rem;
            }

            .controls p {
                font-size: 0.75rem !important;
            }

            .control-button {
                padding: 8px;
                font-size: 0.75rem;
            }

            .layer-badge {
                bottom: 10px;
                right: 10px;
                padding: 10px 15px;
            }

            .layer-count {
                font-size: 1.5rem;
            }

            .layer-label {
                font-size: 0.75rem;
            }

            .tooltip {
                max-width: 280px;
                font-size: 0.85rem;
                padding: 10px 12px;
            }

            .tooltip h4 {
                font-size: 0.95rem;
            }
        }

        @media (max-width: 480px) {
            .header {
                flex-direction: column;
                gap: 10px;
                padding: 10px 15px;
            }

            .view-toggle {
                width: 100%;
            }

            .view-toggle button {
                flex: 1;
            }

            .info-overlay,
            .legend {
                opacity: 0.95;
            }

            .controls {
                opacity: 0.95;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Color schemes
        const COLORS = {
            service: 0x3B82F6,      // Blue
            context: 0x10B981,      // Green
            hook: 0x8B5CF6,         // Purple
            component: 0xF59E0B,    // Orange
            controller: 0xEF4444,   // Red
            monolith: 0x6B7280,     // Gray
            unknown: 0x9CA3AF       // Light gray
        };

        const COLOR_LABELS = {
            service: '#3B82F6',
            context: '#10B981',
            hook: '#8B5CF6',
            component: '#F59E0B',
            controller: '#EF4444',
            monolith: '#6B7280'
        };

        function ArchitectureApp() {
            const [view, setView] = useState('legacy'); // 'legacy' or 'new'
            const [data, setData] = useState(null);
            const [loading, setLoading] = useState(true);
            const [showConnections, setShowConnections] = useState(true);
            const [showUI, setShowUI] = useState(false); // UI panels hidden by default
            const [tooltip, setTooltip] = useState({ visible: false, x: 0, y: 0, content: null });

            useEffect(() => {
                // Load architecture data (EMBEDDED)
                
        // EMBEDDED ARCHITECTURE DATA
        const ARCHITECTURE_DATA = {
  "timestamp": "2025-10-30T08:25:27.350Z",
  "legacy": {
    "name": "Legacy System",
    "type": "monolithic",
    "mainFile": {
      "path": "src/components/UncensoredAudio/audio_uncensored_ai.js",
      "name": "audio_uncensored_ai.js",
      "lines": 5623,
      "systems": [
        "Voice Chat",
        "Device Control",
        "Command Detection",
        "Payment",
        "Conversation",
        "Training Data",
        "TTS",
        "Speech Recognition"
      ]
    },
    "files": [
      {
        "path": "src/components/UncensoredAudio/audio_uncensored_ai.js",
        "name": "audio_uncensored_ai.js",
        "lines": 5623,
        "type": "component",
        "imports": [
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../context/AppContext"
          },
          {
            "named": [
              "useTrainingData"
            ],
            "from": "../../context/TrainingDataContext"
          },
          {
            "named": [
              "Link",
              "useNavigate",
              "useParams"
            ],
            "from": "react-router-dom"
          },
          {
            "named": [
              "useStripe",
              "useElements"
            ],
            "from": "@stripe/react-stripe-js"
          },
          {
            "named": [],
            "default": "PaymentPage",
            "from": "../../pages/PaymentPage"
          },
          {
            "named": [],
            "default": "PaymentModal",
            "from": "../PaymentModal"
          },
          {
            "named": [],
            "default": "TokensExhaustedModal",
            "from": "../modals/TokensExhaustedModal"
          },
          {
            "named": [],
            "default": "NeuralCompatibilityModal",
            "from": "../modals/NeuralCompatibilityModal"
          },
          {
            "named": [],
            "default": "CharacterManager",
            "from": "../Character/CharacterManager"
          },
          {
            "named": [],
            "default": "UserInputSuggestions",
            "from": "./UserInputSuggestions"
          },
          {
            "named": [],
            "default": "MobileNeuralToggle",
            "from": "./MobileNeuralToggle"
          },
          {
            "named": [],
            "default": "MobileTimeUnlock",
            "from": "./MobileTimeUnlock"
          },
          {
            "named": [],
            "default": "ImageGenerationButton",
            "from": "../ImageGeneration/ImageGenerationButton"
          },
          {
            "named": [],
            "default": "InChatImageGenV2",
            "from": "../ImageGeneration/InChatImageGenV2"
          },
          {
            "named": [
              "useMemoryInjection",
              "ConversationSummarizer"
            ],
            "from": "../Memory/MemoryInjectionComponent"
          },
          {
            "named": [],
            "default": "FunscriptGraphViewer",
            "from": "../graphUI/FunscriptGraphViewer"
          },
          {
            "named": [
              "commandAnalyzer"
            ],
            "from": "../SecondaryLLM/CommandAnalyzer"
          },
          {
            "named": [],
            "default": "PointGenerator",
            "from": "../SecondaryLLM/PointGenerator"
          },
          {
            "named": [],
            "default": "RightPanel",
            "from": "./RightPanel"
          },
          {
            "named": [],
            "default": "GeminiLiveModal",
            "from": "./GeminiLiveModal"
          },
          {
            "named": [],
            "default": "VoiceCallModal",
            "from": "./VoiceCallModal"
          },
          {
            "named": [],
            "default": "ElevenLabsVoiceCall",
            "from": "./ElevenLabsVoiceCall"
          },
          {
            "named": [],
            "default": "BackgroundMedia",
            "from": "../shared/BackgroundMedia"
          }
        ],
        "exports": [],
        "functions": [
          "ESTIMATED_TOKENS_PER_WORD",
          "MAX_INPUT_TOKENS",
          "isMobile",
          "getMobileInfo",
          "userAgent",
          "isMobile",
          "isIOS",
          "isChrome",
          "isSafari",
          "isFirefox"
        ]
      },
      {
        "path": "src/components/UncensoredAudio/RightPanel.js",
        "name": "RightPanel.js",
        "lines": 830,
        "type": "component",
        "imports": [
          {
            "named": [
              "Link",
              "useNavigate"
            ],
            "from": "react-router-dom"
          },
          {
            "named": [],
            "default": "FunscriptGraphViewer",
            "from": "../graphUI/FunscriptGraphViewer"
          },
          {
            "named": [
              "ConversationSummarizer"
            ],
            "from": "../Memory/MemoryInjectionComponent"
          },
          {
            "named": [],
            "default": "HandyConnector",
            "from": "../Navbar/HandyConnector"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../context/AppContext"
          },
          {
            "named": [
              "isVideoUrl"
            ],
            "from": "../../utils/mediaUtils"
          }
        ],
        "exports": [],
        "functions": [
          "RightPanel",
          "navigate",
          "fetchStatistics",
          "backendURL",
          "response",
          "data",
          "toggleStatistics",
          "newState",
          "handleViewDetails",
          "handleNeuralToggleChange"
        ]
      },
      {
        "path": "src/components/UncensoredAudio/ElevenLabsVoiceCall.js",
        "name": "ElevenLabsVoiceCall.js",
        "lines": 897,
        "type": "component",
        "imports": [
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../context/AppContext"
          },
          {
            "named": [],
            "default": "ElevenLabsTimeModal",
            "from": "./ElevenLabsTimeModal"
          }
        ],
        "exports": [],
        "functions": [
          "ElevenLabsVoiceCall",
          "backendURL",
          "ALWAYS_FILTER_NARRATION",
          "audioContextRef",
          "gainNodeRef",
          "audioQueueRef",
          "isProcessingAudioRef",
          "currentSourceRef",
          "nextStartTimeRef",
          "lastProcessedResponseRef"
        ]
      },
      {
        "path": "src/components/UncensoredAudio/GeminiLiveModal.js",
        "name": "GeminiLiveModal.js",
        "lines": 1724,
        "type": "component",
        "imports": [
          {
            "named": [
              "GoogleGenAI",
              "Modality",
              "StartSensitivity",
              "EndSensitivity"
            ],
            "from": "@google/genai"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../context/AppContext"
          },
          {
            "named": [],
            "default": "FunscriptGraphViewer",
            "from": "../graphUI/FunscriptGraphViewer"
          }
        ],
        "exports": [],
        "functions": [
          "GeminiLiveModal",
          "messagesEndRef",
          "currentModelResponseRef",
          "currentUserInputRef",
          "transcriptDebounceRef",
          "lastTranscriptLengthRef",
          "hasProcessedEarlyTranscriptRef",
          "TRANSCRIPT_COMPLETION_DELAY",
          "timer",
          "sdkInstance"
        ]
      },
      {
        "path": "src/components/UncensoredAudio/VoiceCallModal.js",
        "name": "VoiceCallModal.js",
        "lines": 896,
        "type": "component",
        "imports": [
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../context/AppContext"
          }
        ],
        "exports": [],
        "functions": [
          "VoiceCallModal",
          "hasActiveSubscription",
          "hasTokens",
          "ELEVENLABS_TOKEN_COST",
          "ELEVENLABS_TIME_MINUTES",
          "isAdminUser",
          "canUseCascade",
          "backendUrl",
          "isCascadeAtCapacity",
          "hasCascadeTime"
        ]
      },
      {
        "path": "src/components/UncensoredAudio/MobileNeuralToggle.js",
        "name": "MobileNeuralToggle.js",
        "lines": 269,
        "type": "component",
        "imports": [
          {
            "named": [],
            "default": "FunscriptGraphViewer",
            "from": "../graphUI/FunscriptGraphViewer"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../context/AppContext"
          }
        ],
        "exports": [],
        "functions": [
          "MobileNeuralToggle",
          "popoverRef",
          "buttonRef",
          "effectiveFirmwareVersion",
          "isV4Firmware",
          "handleClickOutside",
          "handleTogglePopover",
          "isUsingFunscripts",
          "handleEnhancedReset",
          "backendURL"
        ]
      },
      {
        "path": "src/components/UncensoredAudio/MobileTimeUnlock.js",
        "name": "MobileTimeUnlock.js",
        "lines": 57,
        "type": "component",
        "imports": [
          {
            "named": [],
            "default": "React",
            "from": "react"
          }
        ],
        "exports": [],
        "functions": [
          "MobileTimeUnlock",
          "isMobile",
          "hasTime",
          "isUsingFreeMessages",
          "getButtonText",
          "getButtonClass"
        ]
      },
      {
        "path": "src/components/UncensoredAudio/UserInputSuggestions.js",
        "name": "UserInputSuggestions.js",
        "lines": 216,
        "type": "component",
        "imports": [],
        "exports": [],
        "functions": [
          "UserInputSuggestions",
          "backendURL",
          "shouldShowSuggestions",
          "generateSuggestions",
          "systemPrompt",
          "endpoint",
          "response",
          "errorData",
          "data",
          "handleSuggestionClick"
        ]
      }
    ],
    "graph": {
      "nodes": [
        {
          "id": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "name": "audio_uncensored_ai.js",
          "lines": 5623,
          "type": "component",
          "exports": [],
          "functions": [
            "ESTIMATED_TOKENS_PER_WORD",
            "MAX_INPUT_TOKENS",
            "isMobile",
            "getMobileInfo",
            "userAgent",
            "isMobile",
            "isIOS",
            "isChrome",
            "isSafari",
            "isFirefox"
          ]
        },
        {
          "id": "src/components/UncensoredAudio/RightPanel.js",
          "name": "RightPanel.js",
          "lines": 830,
          "type": "component",
          "exports": [],
          "functions": [
            "RightPanel",
            "navigate",
            "fetchStatistics",
            "backendURL",
            "response",
            "data",
            "toggleStatistics",
            "newState",
            "handleViewDetails",
            "handleNeuralToggleChange"
          ]
        },
        {
          "id": "src/components/UncensoredAudio/ElevenLabsVoiceCall.js",
          "name": "ElevenLabsVoiceCall.js",
          "lines": 897,
          "type": "component",
          "exports": [],
          "functions": [
            "ElevenLabsVoiceCall",
            "backendURL",
            "ALWAYS_FILTER_NARRATION",
            "audioContextRef",
            "gainNodeRef",
            "audioQueueRef",
            "isProcessingAudioRef",
            "currentSourceRef",
            "nextStartTimeRef",
            "lastProcessedResponseRef"
          ]
        },
        {
          "id": "src/components/UncensoredAudio/GeminiLiveModal.js",
          "name": "GeminiLiveModal.js",
          "lines": 1724,
          "type": "component",
          "exports": [],
          "functions": [
            "GeminiLiveModal",
            "messagesEndRef",
            "currentModelResponseRef",
            "currentUserInputRef",
            "transcriptDebounceRef",
            "lastTranscriptLengthRef",
            "hasProcessedEarlyTranscriptRef",
            "TRANSCRIPT_COMPLETION_DELAY",
            "timer",
            "sdkInstance"
          ]
        },
        {
          "id": "src/components/UncensoredAudio/VoiceCallModal.js",
          "name": "VoiceCallModal.js",
          "lines": 896,
          "type": "component",
          "exports": [],
          "functions": [
            "VoiceCallModal",
            "hasActiveSubscription",
            "hasTokens",
            "ELEVENLABS_TOKEN_COST",
            "ELEVENLABS_TIME_MINUTES",
            "isAdminUser",
            "canUseCascade",
            "backendUrl",
            "isCascadeAtCapacity",
            "hasCascadeTime"
          ]
        },
        {
          "id": "src/components/UncensoredAudio/MobileNeuralToggle.js",
          "name": "MobileNeuralToggle.js",
          "lines": 269,
          "type": "component",
          "exports": [],
          "functions": [
            "MobileNeuralToggle",
            "popoverRef",
            "buttonRef",
            "effectiveFirmwareVersion",
            "isV4Firmware",
            "handleClickOutside",
            "handleTogglePopover",
            "isUsingFunscripts",
            "handleEnhancedReset",
            "backendURL"
          ]
        },
        {
          "id": "src/components/UncensoredAudio/MobileTimeUnlock.js",
          "name": "MobileTimeUnlock.js",
          "lines": 57,
          "type": "component",
          "exports": [],
          "functions": [
            "MobileTimeUnlock",
            "isMobile",
            "hasTime",
            "isUsingFreeMessages",
            "getButtonText",
            "getButtonClass"
          ]
        },
        {
          "id": "src/components/UncensoredAudio/UserInputSuggestions.js",
          "name": "UserInputSuggestions.js",
          "lines": 216,
          "type": "component",
          "exports": [],
          "functions": [
            "UserInputSuggestions",
            "backendURL",
            "shouldShowSuggestions",
            "generateSuggestions",
            "systemPrompt",
            "endpoint",
            "response",
            "errorData",
            "data",
            "handleSuggestionClick"
          ]
        }
      ],
      "edges": [
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/context/TrainingDataContext.js",
          "imports": [
            "useTrainingData"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "react-router-dom",
          "imports": [
            "Link",
            "useNavigate",
            "useParams"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "@stripe/react-stripe-js",
          "imports": [
            "useStripe",
            "useElements"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/pages/PaymentPage.js",
          "imports": [
            "PaymentPage"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/PaymentModal.js",
          "imports": [
            "PaymentModal"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/modals/TokensExhaustedModal.js",
          "imports": [
            "TokensExhaustedModal"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/modals/NeuralCompatibilityModal.js",
          "imports": [
            "NeuralCompatibilityModal"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/Character/CharacterManager.js",
          "imports": [
            "CharacterManager"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/UncensoredAudio/UserInputSuggestions.js",
          "imports": [
            "UserInputSuggestions"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/UncensoredAudio/MobileNeuralToggle.js",
          "imports": [
            "MobileNeuralToggle"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/UncensoredAudio/MobileTimeUnlock.js",
          "imports": [
            "MobileTimeUnlock"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/ImageGeneration/ImageGenerationButton.js",
          "imports": [
            "ImageGenerationButton"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/ImageGeneration/InChatImageGenV2.js",
          "imports": [
            "InChatImageGenV2"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/Memory/MemoryInjectionComponent.js",
          "imports": [
            "useMemoryInjection",
            "ConversationSummarizer"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/graphUI/FunscriptGraphViewer.js",
          "imports": [
            "FunscriptGraphViewer"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/SecondaryLLM/CommandAnalyzer.js",
          "imports": [
            "commandAnalyzer"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/SecondaryLLM/PointGenerator.js",
          "imports": [
            "PointGenerator"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/UncensoredAudio/RightPanel.js",
          "imports": [
            "RightPanel"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/UncensoredAudio/GeminiLiveModal.js",
          "imports": [
            "GeminiLiveModal"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/UncensoredAudio/VoiceCallModal.js",
          "imports": [
            "VoiceCallModal"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/UncensoredAudio/ElevenLabsVoiceCall.js",
          "imports": [
            "ElevenLabsVoiceCall"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "to": "src/components/shared/BackgroundMedia.js",
          "imports": [
            "BackgroundMedia"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/RightPanel.js",
          "to": "react-router-dom",
          "imports": [
            "Link",
            "useNavigate"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/RightPanel.js",
          "to": "src/components/graphUI/FunscriptGraphViewer.js",
          "imports": [
            "FunscriptGraphViewer"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/RightPanel.js",
          "to": "src/components/Memory/MemoryInjectionComponent.js",
          "imports": [
            "ConversationSummarizer"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/RightPanel.js",
          "to": "src/components/Navbar/HandyConnector.js",
          "imports": [
            "HandyConnector"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/RightPanel.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/RightPanel.js",
          "to": "src/utils/mediaUtils.js",
          "imports": [
            "isVideoUrl"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/ElevenLabsVoiceCall.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/ElevenLabsVoiceCall.js",
          "to": "src/components/UncensoredAudio/ElevenLabsTimeModal.js",
          "imports": [
            "ElevenLabsTimeModal"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/GeminiLiveModal.js",
          "to": "@google/genai",
          "imports": [
            "GoogleGenAI",
            "Modality",
            "StartSensitivity",
            "EndSensitivity"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/GeminiLiveModal.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/GeminiLiveModal.js",
          "to": "src/components/graphUI/FunscriptGraphViewer.js",
          "imports": [
            "FunscriptGraphViewer"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/VoiceCallModal.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/MobileNeuralToggle.js",
          "to": "src/components/graphUI/FunscriptGraphViewer.js",
          "imports": [
            "FunscriptGraphViewer"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/MobileNeuralToggle.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/UncensoredAudio/MobileTimeUnlock.js",
          "to": "react",
          "imports": [
            "React"
          ]
        }
      ]
    }
  },
  "new": {
    "name": "New System (V2)",
    "type": "modular",
    "layers": {
      "services": [
        {
          "path": "src/components/AudioChat/services/ElevenLabsSessionController.js",
          "name": "ElevenLabsSessionController.js",
          "lines": 982,
          "type": "service",
          "imports": [],
          "exports": [
            "elevenLabsSessionController"
          ],
          "functions": [
            "checkResponse",
            "checkData",
            "response",
            "data",
            "AudioContext",
            "contextOptions",
            "storedCustomization",
            "requestBody",
            "response",
            "data"
          ]
        },
        {
          "path": "src/components/AudioChat/services/VoiceSessionController.js",
          "name": "VoiceSessionController.js",
          "lines": 262,
          "type": "service",
          "imports": [],
          "exports": [
            "voiceSessionController"
          ],
          "functions": [
            "voiceSessionController"
          ]
        },
        {
          "path": "src/components/AudioChat/services/aiService.js",
          "name": "aiService.js",
          "lines": 315,
          "type": "service",
          "imports": [],
          "exports": [
            "trimConversation",
            "buildConversationHistory",
            "streamAIResponse",
            "estimateTokenCount",
            "calculateConversationTokens",
            "getLengthInstruction",
            "getNSFWRoleplayInstruction"
          ],
          "functions": [
            "ESTIMATED_TOKENS_PER_WORD",
            "MAX_INPUT_TOKENS",
            "STREAMING_THROTTLE_MS",
            "createThrottle",
            "now",
            "timeSinceLastCall",
            "trimConversation",
            "trimmed",
            "msg",
            "msgTokens"
          ]
        },
        {
          "path": "src/components/AudioChat/services/commandService.js",
          "name": "commandService.js",
          "lines": 337,
          "type": "service",
          "imports": [],
          "exports": [
            "analyzeWithPointGenerator",
            "analyzeWithCommandAnalyzer",
            "getAvailableCommands",
            "applyCommandCustomizations",
            "hasNoInputCommand",
            "extractCommandIndicators",
            "removeCommandMarkers",
            "getDetectionSystem",
            "detectAndExecuteCommands"
          ],
          "functions": [
            "analyzeWithPointGenerator",
            "pg",
            "result",
            "funscriptData",
            "analyzeWithCommandAnalyzer",
            "ca",
            "result",
            "commandData",
            "getAvailableCommands",
            "buildCommandMappingFromAdapter"
          ]
        },
        {
          "path": "src/components/AudioChat/services/contentSafetyService.js",
          "name": "contentSafetyService.js",
          "lines": 78,
          "type": "service",
          "imports": [],
          "exports": [
            "getElevenLabsContentSafetyRules",
            "injectContentSafetyIfNeeded",
            "checkElevenLabsActive",
            "getContentSafetyStatus"
          ],
          "functions": [
            "getElevenLabsContentSafetyRules",
            "injectContentSafetyIfNeeded",
            "checkElevenLabsActive",
            "getContentSafetyStatus"
          ]
        },
        {
          "path": "src/components/AudioChat/services/deviceService.js",
          "name": "deviceService.js",
          "lines": 280,
          "type": "service",
          "imports": [],
          "exports": [
            "calculateFunscriptDuration",
            "executeFunscriptCommand",
            "stopDevice",
            "globalStopAllFunscripts",
            "isDeviceConnected",
            "getControllerForFirmware",
            "getHandyConnectionKey",
            "isValidFunscript",
            "parseFunscriptData",
            "getFunscriptMetadata",
            "createVisualizationData",
            "isDeviceReady",
            "getDeviceStatus"
          ],
          "functions": [
            "calculateFunscriptDuration",
            "lastAction",
            "executeFunscriptCommand",
            "stopDevice",
            "globalStopAllFunscripts",
            "isDeviceConnected",
            "getControllerForFirmware",
            "effectiveVersion",
            "versionNumber",
            "getHandyConnectionKey"
          ]
        },
        {
          "path": "src/components/AudioChat/services/enhancedConversationService.js",
          "name": "enhancedConversationService.js",
          "lines": 189,
          "type": "service",
          "imports": [],
          "exports": [
            "initializeEnhancedSession",
            "saveToEnhancedConversation",
            "getEnhancedConversation",
            "fetchFavoritePatterns",
            "selectBestConversation",
            "calculateConversationTier",
            "getTierDescription"
          ],
          "functions": [
            "initializeEnhancedSession",
            "backendURL",
            "response",
            "data",
            "saveToEnhancedConversation",
            "backendURL",
            "response",
            "data",
            "getEnhancedConversation",
            "backendURL"
          ]
        },
        {
          "path": "src/components/AudioChat/services/index.js",
          "name": "index.js",
          "lines": 15,
          "type": "service",
          "imports": [],
          "exports": [],
          "functions": []
        },
        {
          "path": "src/components/AudioChat/services/paymentService.js",
          "name": "paymentService.js",
          "lines": 320,
          "type": "service",
          "imports": [],
          "exports": [
            "calculateRemainingTime",
            "checkAccess",
            "shouldShowExtensionModal",
            "shouldPulseTimeButton",
            "unlockTime",
            "attemptAutoUnlock",
            "getRemainingFreeMessages",
            "formatRemainingTime",
            "getTimeStatus",
            "shouldDecrementFreeMessage",
            "getTimeUnlockConfig"
          ],
          "functions": [
            "calculateRemainingTime",
            "now",
            "expiryTime",
            "diffMs",
            "diffMinutes",
            "checkAccess",
            "hasAccess",
            "shouldShowExtensionModal",
            "shouldPulseTimeButton",
            "unlockTime"
          ]
        },
        {
          "path": "src/components/AudioChat/services/settingsManager.js",
          "name": "settingsManager.js",
          "lines": 199,
          "type": "service",
          "imports": [],
          "exports": [
            "settings"
          ],
          "functions": [
            "SETTINGS_DEFAULTS",
            "saved",
            "stored",
            "defaultValue",
            "settings",
            "settings",
            "eventName",
            "handler",
            "event",
            "settings"
          ]
        },
        {
          "path": "src/components/AudioChat/services/speechRecognitionService.js",
          "name": "speechRecognitionService.js",
          "lines": 195,
          "type": "service",
          "imports": [],
          "exports": [
            "getMobileInfo",
            "isMobile",
            "checkSpeechRecognitionSupport",
            "initializeSpeechRecognition",
            "setupRecognitionHandlers",
            "requestMicrophonePermission",
            "getSpeechRecognitionErrorMessage",
            "getRecognitionRestartDelay"
          ],
          "functions": [
            "getMobileInfo",
            "userAgent",
            "isMobile",
            "isIOS",
            "isChrome",
            "isSafari",
            "isFirefox",
            "isMobile",
            "checkSpeechRecognitionSupport",
            "hasWebkitSpeechRecognition"
          ]
        },
        {
          "path": "src/components/AudioChat/services/ttsService.js",
          "name": "ttsService.js",
          "lines": 258,
          "type": "service",
          "imports": [],
          "exports": [
            "playGoogleTTS",
            "stopGoogleTTS",
            "isElevenLabsActive",
            "processElevenLabsResponse",
            "stopElevenLabsTTS",
            "cleanTextForTTS",
            "splitIntoSentences",
            "getTTSProvider",
            "fetchAvailableVoices",
            "getOrCreateAudioContext",
            "resumeAudioContext",
            "requestAutoplayPermission"
          ],
          "functions": [
            "playGoogleTTS",
            "backendURL",
            "response",
            "audioBlob",
            "audioUrl",
            "audio",
            "playPromise",
            "stopGoogleTTS",
            "isElevenLabsActive",
            "processElevenLabsResponse"
          ]
        }
      ],
      "contexts": [
        {
          "path": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "name": "AudioChatProvider.jsx",
          "lines": 453,
          "type": "context",
          "imports": [
            {
              "named": [
                "settings"
              ],
              "from": "../services/settingsManager"
            },
            {
              "named": [
                "voiceSessionController"
              ],
              "from": "../services/VoiceSessionController"
            },
            {
              "named": [
                "elevenLabsSessionController"
              ],
              "from": "../services/ElevenLabsSessionController"
            }
          ],
          "exports": [
            "AudioChatProvider",
            "useAudioChat"
          ],
          "functions": [
            "AudioChatContext",
            "AudioChatProvider",
            "controller",
            "elevenLabsController",
            "oldValue",
            "newValue",
            "autoContinueTimeoutRef",
            "autoContinueIntervalRef",
            "onTTSCompleteRef",
            "onTTSStartRef"
          ]
        },
        {
          "path": "src/components/AudioChat/context/DeviceControlProvider.jsx",
          "name": "DeviceControlProvider.jsx",
          "lines": 295,
          "type": "context",
          "imports": [
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../context/AppContext"
            },
            {
              "named": [
                "calculateFunscriptDuration",
                "getControllerForFirmware",
                "isDeviceReady",
                "getDeviceStatus",
                "isValidFunscript",
                "parseFunscriptData",
                "getFunscriptMetadata"
              ],
              "from": "../services/deviceService"
            }
          ],
          "exports": [
            "DeviceControlProvider",
            "useDeviceControl"
          ],
          "functions": [
            "DeviceControlContext",
            "DeviceControlProvider",
            "funscriptTimeoutRef",
            "deviceReadyTimeoutRef",
            "movementPollingRef",
            "lastPositionRef",
            "movementDetectionStartTimeRef",
            "effectiveFirmwareVersion",
            "controllerName",
            "deviceReady"
          ]
        },
        {
          "path": "src/components/AudioChat/context/SpeechRecognitionProvider.jsx",
          "name": "SpeechRecognitionProvider.jsx",
          "lines": 319,
          "type": "context",
          "imports": [
            {
              "named": [
                "getMobileInfo",
                "checkSpeechRecognitionSupport",
                "initializeSpeechRecognition",
                "setupRecognitionHandlers",
                "getRecognitionRestartDelay"
              ],
              "from": "../services/speechRecognitionService"
            }
          ],
          "exports": [
            "SpeechRecognitionProvider",
            "useSpeechRecognition"
          ],
          "functions": [
            "SpeechRecognitionContext",
            "SpeechRecognitionProvider",
            "mobileInfo",
            "recognitionRef",
            "isRecognitionActiveRef",
            "currentTranscriptRef",
            "lastSpeechEndTimeRef",
            "selectedLanguageRef",
            "speechSubmissionTimerRef",
            "speechDetectedThisSessionRef"
          ]
        },
        {
          "path": "src/components/AudioChat/context/TTSProvider.jsx",
          "name": "TTSProvider.jsx",
          "lines": 272,
          "type": "context",
          "imports": [
            {
              "named": [
                "useAudioChat"
              ],
              "from": "./AudioChatProvider"
            },
            {
              "named": [
                "playGoogleTTS",
                "stopGoogleTTS",
                "processElevenLabsResponse",
                "stopElevenLabsTTS",
                "isElevenLabsActive",
                "cleanTextForTTS",
                "getTTSProvider"
              ],
              "from": "../services/ttsService"
            }
          ],
          "exports": [
            "TTSProvider",
            "useTTS"
          ],
          "functions": [
            "TTSContext",
            "TTSProvider",
            "currentAudioRef",
            "ttsPlayingRef",
            "speechInProgressRef",
            "playTTS",
            "ttsProvider",
            "cleanedText",
            "playGoogleTTSInternal",
            "localResponseId"
          ]
        },
        {
          "path": "src/components/AudioChat/context/index.js",
          "name": "index.js",
          "lines": 10,
          "type": "context",
          "imports": [],
          "exports": [],
          "functions": []
        }
      ],
      "hooks": [
        {
          "path": "src/components/AudioChat/hooks/index.js",
          "name": "index.js",
          "lines": 16,
          "type": "hook",
          "imports": [],
          "exports": [],
          "functions": []
        },
        {
          "path": "src/components/AudioChat/hooks/useAIInference.js",
          "name": "useAIInference.js",
          "lines": 405,
          "type": "hook",
          "imports": [
            {
              "named": [
                "useState",
                "useCallback",
                "useRef"
              ],
              "from": "react"
            },
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../context/AppContext"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../context/AudioChatProvider"
            },
            {
              "named": [
                "useMemoryManagement"
              ],
              "from": "./useMemoryManagement"
            },
            {
              "named": [
                "buildConversationHistory",
                "streamAIResponse",
                "getLengthInstruction",
                "getNSFWRoleplayInstruction"
              ],
              "from": "../services/aiService"
            },
            {
              "named": [
                "saveToEnhancedConversation",
                "getEnhancedConversation"
              ],
              "from": "../services/enhancedConversationService"
            },
            {
              "named": [
                "injectContentSafetyIfNeeded"
              ],
              "from": "../services/contentSafetyService"
            }
          ],
          "exports": [
            "useAIInference"
          ],
          "functions": [
            "useAIInference",
            "memory",
            "memoryPrompt",
            "getCharacter",
            "charactersObj",
            "sendMessage",
            "executeDetectedCommand",
            "accessResult",
            "unlockResult",
            "responseId"
          ]
        },
        {
          "path": "src/components/AudioChat/hooks/useAutoContinuation.js",
          "name": "useAutoContinuation.js",
          "lines": 160,
          "type": "hook",
          "imports": [
            {
              "named": [
                "useState",
                "useRef",
                "useCallback",
                "useEffect"
              ],
              "from": "react"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../context/AudioChatProvider"
            }
          ],
          "exports": [
            "useAutoContinuation"
          ],
          "functions": [
            "useAutoContinuation",
            "onContinueRef",
            "start",
            "delay",
            "newValue",
            "cancel",
            "reset",
            "shouldAutoContinue",
            "handleNoInputDetected"
          ]
        },
        {
          "path": "src/components/AudioChat/hooks/useCommandDetection.js",
          "name": "useCommandDetection.js",
          "lines": 294,
          "type": "hook",
          "imports": [
            {
              "named": [
                "useState",
                "useCallback",
                "useRef"
              ],
              "from": "react"
            },
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../context/AppContext"
            },
            {
              "named": [
                "useDeviceControl"
              ],
              "from": "../context/DeviceControlProvider"
            },
            {
              "named": [
                "useTrainingData"
              ],
              "from": "../../../context/TrainingDataContext"
            },
            {
              "named": [
                "detectAndExecuteCommands",
                "hasNoInputCommand",
                "extractCommandIndicators",
                "applyCommandCustomizations",
                "getAvailableCommands"
              ],
              "from": "../services/commandService"
            },
            {
              "named": [
                "fetchFavoritePatterns"
              ],
              "from": "../services/enhancedConversationService"
            },
            {
              "named": [
                "commandAnalyzer"
              ],
              "from": "../../SecondaryLLM/CommandAnalyzer"
            },
            {
              "named": [],
              "default": "PointGenerator",
              "from": "../../SecondaryLLM/PointGenerator"
            }
          ],
          "exports": [
            "useCommandDetection"
          ],
          "functions": [
            "useCommandDetection",
            "trainingDataLogger",
            "pointGeneratorRef",
            "getCharacter",
            "charactersObj",
            "detectCommands",
            "hasNoInputCmd",
            "character",
            "conversationHistory",
            "recentHistory"
          ]
        },
        {
          "path": "src/components/AudioChat/hooks/useConversationInitializer.js",
          "name": "useConversationInitializer.js",
          "lines": 139,
          "type": "hook",
          "imports": [
            {
              "named": [
                "useEffect",
                "useState",
                "useRef"
              ],
              "from": "react"
            },
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../context/AppContext"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../context/AudioChatProvider"
            },
            {
              "named": [
                "getEnhancedConversation"
              ],
              "from": "../services/enhancedConversationService"
            }
          ],
          "exports": [
            "useConversationInitializer"
          ],
          "functions": [
            "loadingCharacters",
            "useConversationInitializer",
            "existingConversation",
            "initializeConversation",
            "enhanced",
            "conversation",
            "temporal",
            "reloadConversation"
          ]
        },
        {
          "path": "src/components/AudioChat/hooks/useImageGeneration.js",
          "name": "useImageGeneration.js",
          "lines": 167,
          "type": "hook",
          "imports": [
            {
              "named": [
                "useCallback"
              ],
              "from": "react"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../context/AudioChatProvider"
            }
          ],
          "exports": [
            "useImageGeneration"
          ],
          "functions": [
            "useImageGeneration",
            "setProvider",
            "setStyle",
            "setQuality",
            "setNegativePrompt",
            "startGeneration",
            "completeGeneration",
            "cancelGeneration",
            "viewImage",
            "closeImageModal"
          ]
        },
        {
          "path": "src/components/AudioChat/hooks/useMemoryManagement.js",
          "name": "useMemoryManagement.js",
          "lines": 162,
          "type": "hook",
          "imports": [
            {
              "named": [
                "useCallback",
                "useEffect",
                "useMemo"
              ],
              "from": "react"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../context/AudioChatProvider"
            },
            {
              "named": [
                "useMemoryInjection"
              ],
              "from": "../../Memory/MemoryInjectionComponent"
            }
          ],
          "exports": [
            "useMemoryManagement"
          ],
          "functions": [
            "useMemoryManagement",
            "toggleSentientMode",
            "currentValue",
            "newValue",
            "enableSentientMode",
            "disableSentientMode",
            "refresh",
            "getMemoryStats",
            "shouldInjectMemory",
            "getSessionDurationMinutes"
          ]
        },
        {
          "path": "src/components/AudioChat/hooks/useMobileSpeechRecognition.js",
          "name": "useMobileSpeechRecognition.js",
          "lines": 153,
          "type": "hook",
          "imports": [
            {
              "named": [
                "useCallback",
                "useMemo"
              ],
              "from": "react"
            },
            {
              "named": [
                "useSpeechRecognition"
              ],
              "from": "../context/SpeechRecognitionProvider"
            },
            {
              "named": [
                "getSpeechRecognitionErrorMessage"
              ],
              "from": "../services/speechRecognitionService"
            }
          ],
          "exports": [
            "useMobileSpeechRecognition"
          ],
          "functions": [
            "useMobileSpeechRecognition",
            "getErrorMessage",
            "hasGoodSupport",
            "getInstructions",
            "getRecognitionMode",
            "startWithDelay",
            "shouldShowInterim",
            "getPlatformDebugInfo"
          ]
        },
        {
          "path": "src/components/AudioChat/hooks/usePaymentManagement.js",
          "name": "usePaymentManagement.js",
          "lines": 455,
          "type": "hook",
          "imports": [
            {
              "named": [
                "useState",
                "useEffect",
                "useCallback",
                "useRef"
              ],
              "from": "react"
            },
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../context/AppContext"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../context/AudioChatProvider"
            },
            {
              "named": [
                "calculateRemainingTime",
                "checkAccess",
                "shouldShowExtensionModal",
                "shouldPulseTimeButton",
                "unlockTime",
                "attemptAutoUnlock",
                "getRemainingFreeMessages as getRemainingFreeMessagesUtil",
                "formatRemainingTime",
                "getTimeStatus",
                "shouldDecrementFreeMessage",
                "getTimeUnlockConfig"
              ],
              "from": "../services/paymentService"
            }
          ],
          "exports": [
            "usePaymentManagement"
          ],
          "functions": [
            "usePaymentManagement",
            "intervalIdRef",
            "extensionModalShownRef",
            "cascadeIntervalIdRef",
            "config",
            "isCurrentCharacterFree",
            "updateTimeTracking",
            "timeLeft",
            "updateFreeMessageTracking",
            "freeMessages"
          ]
        },
        {
          "path": "src/components/AudioChat/hooks/useTrainingDataCollection.js",
          "name": "useTrainingDataCollection.js",
          "lines": 86,
          "type": "hook",
          "imports": [
            {
              "named": [
                "useCallback"
              ],
              "from": "react"
            },
            {
              "named": [
                "useTrainingData"
              ],
              "from": "../../../context/TrainingDataContext"
            }
          ],
          "exports": [
            "useTrainingDataCollection"
          ],
          "functions": [
            "useTrainingDataCollection",
            "trainingDataLogger",
            "logPointGeneratorData",
            "logCommandAnalyzerData",
            "isEnabled",
            "getLogger"
          ]
        },
        {
          "path": "src/components/AudioChat/hooks/useVoiceChat.js",
          "name": "useVoiceChat.js",
          "lines": 211,
          "type": "hook",
          "imports": [
            {
              "named": [
                "useCallback"
              ],
              "from": "react"
            },
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../context/AppContext"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../context/AudioChatProvider"
            },
            {
              "named": [
                "useSpeechRecognition"
              ],
              "from": "../context/SpeechRecognitionProvider"
            },
            {
              "named": [
                "useTTS"
              ],
              "from": "../context/TTSProvider"
            },
            {
              "named": [
                "useDeviceControl"
              ],
              "from": "../context/DeviceControlProvider"
            },
            {
              "named": [
                "requestMicrophonePermission"
              ],
              "from": "../services/speechRecognitionService"
            },
            {
              "named": [
                "requestAutoplayPermission",
                "resumeAudioContext"
              ],
              "from": "../services/ttsService"
            },
            {
              "named": [
                "elevenLabsSessionController"
              ],
              "from": "../services/ElevenLabsSessionController"
            }
          ],
          "exports": [
            "useVoiceChat"
          ],
          "functions": [
            "useVoiceChat",
            "startSession",
            "accessResult",
            "hasMicPermission",
            "stopSession",
            "toggleSession",
            "canStartSession",
            "getSessionStatus"
          ]
        }
      ],
      "components": [
        {
          "path": "src/components/AudioChat/AudioChatNew.jsx",
          "name": "AudioChatNew.jsx",
          "lines": 441,
          "type": "component",
          "imports": [
            {
              "named": [
                "useParams",
                "useNavigate"
              ],
              "from": "react-router-dom"
            },
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../context/AppContext"
            },
            {
              "named": [
                "AudioChatProvider",
                "useAudioChat",
                "SpeechRecognitionProvider",
                "useSpeechRecognition",
                "TTSProvider",
                "useTTS",
                "DeviceControlProvider"
              ],
              "from": "./context"
            },
            {
              "named": [
                "useAIInference",
                "useCommandDetection",
                "useAutoContinuation",
                "usePaymentManagement",
                "useConversationInitializer"
              ],
              "from": "./hooks"
            },
            {
              "named": [
                "ChatLayout"
              ],
              "from": "./components/layout"
            },
            {
              "named": [
                "ModalSystem"
              ],
              "from": "./components/modals"
            },
            {
              "named": [],
              "default": "ElevenLabsIndicator",
              "from": "./components/indicators/ElevenLabsIndicator"
            }
          ],
          "exports": [],
          "functions": [
            "AudioChatCore",
            "navigate",
            "AudioChatWithCallbacks",
            "payment",
            "commandDetection",
            "aiInference",
            "autoContinuation",
            "handleSpeechDetected",
            "handleSpeechResult",
            "accessResult"
          ]
        },
        {
          "path": "src/components/AudioChat/AudioChatWrapper.jsx",
          "name": "AudioChatWrapper.jsx",
          "lines": 133,
          "type": "component",
          "imports": [
            {
              "named": [],
              "default": "React",
              "from": "react"
            },
            {
              "named": [],
              "default": "UncensoredAI_Audio",
              "from": "../UncensoredAudio/audio_uncensored_ai"
            },
            {
              "named": [],
              "default": "AudioChatNew",
              "from": "./AudioChatNew"
            }
          ],
          "exports": [
            "enableNewAudioChat",
            "disableNewAudioChat",
            "clearAudioChatOverride",
            "getAudioChatVersion"
          ],
          "functions": [
            "AudioChatWrapper",
            "useNewAudioChat",
            "localStorageOverride",
            "shouldUseNew",
            "enableNewAudioChat",
            "disableNewAudioChat",
            "clearAudioChatOverride",
            "getAudioChatVersion",
            "localStorageOverride",
            "useNewAudioChat"
          ]
        },
        {
          "path": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "name": "ChatInputArea.jsx",
          "lines": 332,
          "type": "component",
          "imports": [
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../../context/AppContext"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../../context/AudioChatProvider"
            },
            {
              "named": [
                "useTTS"
              ],
              "from": "../../context/TTSProvider"
            },
            {
              "named": [
                "useVoiceChat"
              ],
              "from": "../../hooks/useVoiceChat"
            },
            {
              "named": [
                "useAIInference"
              ],
              "from": "../../hooks/useAIInference"
            },
            {
              "named": [
                "useAutoContinuation"
              ],
              "from": "../../hooks/useAutoContinuation"
            },
            {
              "named": [
                "useCommandDetection"
              ],
              "from": "../../hooks/useCommandDetection"
            },
            {
              "named": [
                "usePaymentManagement"
              ],
              "from": "../../hooks/usePaymentManagement"
            },
            {
              "named": [
                "useDeviceControl"
              ],
              "from": "../../context/DeviceControlProvider"
            },
            {
              "named": [],
              "default": "UserInputSuggestions",
              "from": "../../../UncensoredAudio/UserInputSuggestions"
            },
            {
              "named": [],
              "default": "InChatImageGenV2",
              "from": "../../../ImageGeneration/InChatImageGenV2"
            },
            {
              "named": [],
              "default": "MobileTimeUnlock",
              "from": "../../../UncensoredAudio/MobileTimeUnlock"
            },
            {
              "named": [],
              "default": "MobileNeuralToggle",
              "from": "../../../UncensoredAudio/MobileNeuralToggle"
            }
          ],
          "exports": [],
          "functions": [
            "ChatInputArea",
            "payment",
            "charactersObj",
            "character",
            "conversation",
            "voiceChat",
            "aiInference",
            "autoContinuation",
            "commandDetection",
            "textareaRef"
          ]
        },
        {
          "path": "src/components/AudioChat/components/chat/ChatMessages.jsx",
          "name": "ChatMessages.jsx",
          "lines": 151,
          "type": "component",
          "imports": [
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../../context/AppContext"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../../context/AudioChatProvider"
            },
            {
              "named": [],
              "default": "MessageBubble",
              "from": "./MessageBubble"
            }
          ],
          "exports": [],
          "functions": [
            "ChatMessages",
            "messagesContainerRef",
            "hasScrolledOnceRef",
            "lastScrollHeightRef",
            "isNearBottomRef",
            "conversation",
            "charactersObj",
            "character",
            "container",
            "handleScroll"
          ]
        },
        {
          "path": "src/components/AudioChat/components/chat/CommandIndicators.jsx",
          "name": "CommandIndicators.jsx",
          "lines": 27,
          "type": "component",
          "imports": [
            {
              "named": [],
              "default": "React",
              "from": "react"
            }
          ],
          "exports": [],
          "functions": [
            "CommandIndicators"
          ]
        },
        {
          "path": "src/components/AudioChat/components/chat/FormattedMessageText.jsx",
          "name": "FormattedMessageText.jsx",
          "lines": 61,
          "type": "component",
          "imports": [
            {
              "named": [
                "parseMessageFormatting"
              ],
              "from": "../../utils/messageFormatting"
            }
          ],
          "exports": [],
          "functions": [
            "FormattedMessageText",
            "segments"
          ]
        },
        {
          "path": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "name": "MessageBubble.jsx",
          "lines": 297,
          "type": "component",
          "imports": [
            {
              "named": [],
              "default": "FormattedMessageText",
              "from": "./FormattedMessageText"
            },
            {
              "named": [],
              "default": "CommandIndicators",
              "from": "./CommandIndicators"
            },
            {
              "named": [
                "useTTS"
              ],
              "from": "../../context/TTSProvider"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../../context/AudioChatProvider"
            },
            {
              "named": [
                "useDeviceControl"
              ],
              "from": "../../context/DeviceControlProvider"
            },
            {
              "named": [
                "useAIInference"
              ],
              "from": "../../hooks/useAIInference"
            },
            {
              "named": [
                "usePaymentManagement"
              ],
              "from": "../../hooks/usePaymentManagement"
            },
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../../context/AppContext"
            },
            {
              "named": [
                "ConversationSummarizer"
              ],
              "from": "../../../Memory/MemoryInjectionComponent"
            },
            {
              "named": [
                "processMessageWithCommands",
                "formatTimestamp",
                "getMessageClassName",
                "isAssistantMessage"
              ],
              "from": "../../utils/messageFormatting"
            }
          ],
          "exports": [],
          "functions": [
            "arePropsEqual",
            "MessageBubbleComponent",
            "aiInference",
            "payment",
            "commandIndicators",
            "hasNoInput",
            "cleanedText",
            "charactersObj",
            "character",
            "conversation"
          ]
        },
        {
          "path": "src/components/AudioChat/components/chat/TimeDisplay.jsx",
          "name": "TimeDisplay.jsx",
          "lines": 56,
          "type": "component",
          "imports": [
            {
              "named": [],
              "default": "React",
              "from": "react"
            },
            {
              "named": [
                "usePaymentManagement"
              ],
              "from": "../../hooks/usePaymentManagement"
            }
          ],
          "exports": [],
          "functions": [
            "TimeDisplay",
            "payment",
            "status"
          ]
        },
        {
          "path": "src/components/AudioChat/components/chat/index.js",
          "name": "index.js",
          "lines": 12,
          "type": "component",
          "imports": [],
          "exports": [],
          "functions": []
        },
        {
          "path": "src/components/AudioChat/components/index.js",
          "name": "index.js",
          "lines": 17,
          "type": "component",
          "imports": [],
          "exports": [],
          "functions": []
        },
        {
          "path": "src/components/AudioChat/components/indicators/ElevenLabsIndicator.jsx",
          "name": "ElevenLabsIndicator.jsx",
          "lines": 134,
          "type": "component",
          "imports": [
            {
              "named": [
                "elevenLabsSessionController"
              ],
              "from": "../../services/ElevenLabsSessionController"
            }
          ],
          "exports": [],
          "functions": [
            "ElevenLabsIndicator",
            "interval"
          ]
        },
        {
          "path": "src/components/AudioChat/components/layout/ChatLayout.jsx",
          "name": "ChatLayout.jsx",
          "lines": 203,
          "type": "component",
          "imports": [
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../../context/AppContext"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../../context/AudioChatProvider"
            },
            {
              "named": [
                "useMemoryManagement"
              ],
              "from": "../../hooks/useMemoryManagement"
            },
            {
              "named": [
                "usePaymentManagement"
              ],
              "from": "../../hooks/usePaymentManagement"
            },
            {
              "named": [
                "useDeviceControl"
              ],
              "from": "../../context/DeviceControlProvider"
            },
            {
              "named": [],
              "default": "MobileHeader",
              "from": "./MobileHeader"
            },
            {
              "named": [],
              "default": "ChatMainContent",
              "from": "./ChatMainContent"
            },
            {
              "named": [],
              "default": "RightPanel",
              "from": "../../../UncensoredAudio/RightPanel"
            }
          ],
          "exports": [],
          "functions": [
            "SUPPORTED_MODELS",
            "ChatLayout",
            "memory",
            "payment",
            "effectiveFirmwareVersion",
            "isV4Firmware",
            "forceCommandAnalyzer",
            "usePointGenerator",
            "charactersObj",
            "character"
          ]
        },
        {
          "path": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
          "name": "ChatMainContent.jsx",
          "lines": 66,
          "type": "component",
          "imports": [
            {
              "named": [],
              "default": "React",
              "from": "react"
            },
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../../context/AppContext"
            },
            {
              "named": [],
              "default": "ChatMessages",
              "from": "../chat/ChatMessages"
            },
            {
              "named": [],
              "default": "ChatInputArea",
              "from": "../chat/ChatInputArea"
            },
            {
              "named": [],
              "default": "TimeDisplay",
              "from": "../chat/TimeDisplay"
            },
            {
              "named": [],
              "default": "BackgroundMedia",
              "from": "../../../shared/BackgroundMedia"
            },
            {
              "named": [
                "useDeviceControl"
              ],
              "from": "../../context/DeviceControlProvider"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../../context/AudioChatProvider"
            }
          ],
          "exports": [],
          "functions": [
            "ChatMainContent",
            "allCharacters",
            "character"
          ]
        },
        {
          "path": "src/components/AudioChat/components/layout/MobileHeader.jsx",
          "name": "MobileHeader.jsx",
          "lines": 81,
          "type": "component",
          "imports": [
            {
              "named": [
                "useNavigate"
              ],
              "from": "react-router-dom"
            },
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../../context/AppContext"
            }
          ],
          "exports": [],
          "functions": [
            "MobileHeader",
            "navigate",
            "allCharacters",
            "character",
            "handleVerticalNavToggle",
            "verticalNav",
            "handleViewCharacter"
          ]
        },
        {
          "path": "src/components/AudioChat/components/layout/index.js",
          "name": "index.js",
          "lines": 9,
          "type": "component",
          "imports": [],
          "exports": [],
          "functions": []
        },
        {
          "path": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "name": "ModalSystem.jsx",
          "lines": 394,
          "type": "component",
          "imports": [
            {
              "named": [
                "useNavigate"
              ],
              "from": "react-router-dom"
            },
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../../../context/AppContext"
            },
            {
              "named": [
                "useAudioChat"
              ],
              "from": "../../context/AudioChatProvider"
            },
            {
              "named": [
                "useVoiceChat"
              ],
              "from": "../../hooks/useVoiceChat"
            },
            {
              "named": [
                "usePaymentManagement"
              ],
              "from": "../../hooks/usePaymentManagement"
            },
            {
              "named": [
                "useCommandDetection"
              ],
              "from": "../../hooks/useCommandDetection"
            },
            {
              "named": [
                "useSpeechRecognition"
              ],
              "from": "../../context/SpeechRecognitionProvider"
            },
            {
              "named": [],
              "default": "GeminiLiveModal",
              "from": "../../../UncensoredAudio/GeminiLiveModal"
            },
            {
              "named": [],
              "default": "VoiceCallModal",
              "from": "../../../UncensoredAudio/VoiceCallModal"
            },
            {
              "named": [],
              "default": "PaymentModal",
              "from": "../../../PaymentModal"
            },
            {
              "named": [],
              "default": "TokensExhaustedModal",
              "from": "../../../modals/TokensExhaustedModal"
            }
          ],
          "exports": [],
          "functions": [
            "ModalSystem",
            "navigate",
            "payment",
            "voiceChat",
            "commandDetection",
            "charactersObj",
            "character",
            "handleRegularVoiceSelected",
            "handleCascadeVoiceSelected",
            "cascadeStatus"
          ]
        },
        {
          "path": "src/components/AudioChat/components/modals/index.js",
          "name": "index.js",
          "lines": 7,
          "type": "component",
          "imports": [],
          "exports": [],
          "functions": []
        },
        {
          "path": "src/components/AudioChat/index.js",
          "name": "index.js",
          "lines": 30,
          "type": "component",
          "imports": [],
          "exports": [],
          "functions": []
        },
        {
          "path": "src/components/AudioChat/utils/index.js",
          "name": "index.js",
          "lines": 7,
          "type": "component",
          "imports": [],
          "exports": [],
          "functions": []
        },
        {
          "path": "src/components/AudioChat/utils/messageFormatting.js",
          "name": "messageFormatting.js",
          "lines": 225,
          "type": "component",
          "imports": [],
          "exports": [
            "processMessageWithCommands",
            "formatTimestamp",
            "parseMessageFormatting",
            "getMessageStats",
            "truncateText",
            "removeNarration",
            "extractDialogue",
            "isUserMessage",
            "isAssistantMessage",
            "getMessageClassName"
          ],
          "functions": [
            "processMessageWithCommands",
            "commandPattern",
            "commandIndicators",
            "commandName",
            "hasNoInput",
            "formatTimestamp",
            "date",
            "hours",
            "minutes",
            "parseMessageFormatting"
          ]
        },
        {
          "path": "src/pages/AdapterSettings.js",
          "name": "AdapterSettings.js",
          "lines": 1826,
          "type": "component",
          "imports": [
            {
              "named": [
                "useNavigate"
              ],
              "from": "react-router-dom"
            },
            {
              "named": [
                "useAppContext"
              ],
              "from": "../context/AppContext"
            },
            {
              "named": [],
              "default": "axios",
              "from": "axios"
            },
            {
              "named": [],
              "default": "FunscriptGraphViewer",
              "from": "../components/graphUI/FunscriptGraphViewer"
            },
            {
              "named": [],
              "default": "AdapterCard",
              "from": "../components/AdapterSettings/AdapterCard"
            },
            {
              "named": [
                "getBlurredCharacterBackground"
              ],
              "from": "../utils/characterBackgrounds"
            }
          ],
          "exports": [],
          "functions": [
            "AdapterSettings",
            "navigate",
            "fileInputRefs",
            "backendURL",
            "formatRelativeTime",
            "date",
            "now",
            "diffMs",
            "diffSecs",
            "diffMins"
          ]
        },
        {
          "path": "src/components/AdapterSettings/AdapterCard.js",
          "name": "AdapterCard.js",
          "lines": 120,
          "type": "component",
          "imports": [
            {
              "named": [],
              "default": "React",
              "from": "react"
            }
          ],
          "exports": [],
          "functions": [
            "AdapterCard",
            "formatSize",
            "getStatusColor",
            "getStatusLabel"
          ]
        },
        {
          "path": "src/components/AdminComponents/CommandCollectionManager.js",
          "name": "CommandCollectionManager.js",
          "lines": 953,
          "type": "component",
          "imports": [
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../context/AppContext"
            },
            {
              "named": [],
              "default": "FunscriptGraphViewer",
              "from": "../graphUI/FunscriptGraphViewer"
            }
          ],
          "exports": [],
          "functions": [
            "CommandCollectionManager",
            "fileInputRef",
            "funscriptInputRefs",
            "backendURL",
            "fetchCollections",
            "response",
            "data",
            "handleCreateCollection",
            "response",
            "data"
          ]
        }
      ],
      "controllers": [
        {
          "path": "src/components/Character/FunscriptController.js",
          "name": "FunscriptController.js",
          "lines": 1158,
          "type": "controller",
          "imports": [
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../context/AppContext"
            }
          ],
          "exports": [],
          "functions": [
            "newHandy",
            "connectIfNeeded",
            "startPlaybackMonitoring",
            "interval",
            "elapsed",
            "remaining",
            "handlePlaybackEnded",
            "stopPlaybackMonitoring",
            "restartCurrentFunscript",
            "restartCurrentFunscriptWithFullProcess"
          ]
        },
        {
          "path": "src/components/Character/HsspFunscriptController.js",
          "name": "HsspFunscriptController.js",
          "lines": 812,
          "type": "controller",
          "imports": [
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../context/AppContext"
            }
          ],
          "exports": [],
          "functions": [
            "effectiveFirmwareVersion",
            "isV4OrHigher",
            "isV3OrHigher",
            "newHandy",
            "connectIfNeeded",
            "calculateFunscriptDuration",
            "script",
            "metadataDuration",
            "actions",
            "lastAction"
          ]
        },
        {
          "path": "src/components/Character/StreamingFunscriptController.js",
          "name": "StreamingFunscriptController.js",
          "lines": 1922,
          "type": "controller",
          "imports": [
            {
              "named": [
                "useAppContext"
              ],
              "from": "../../context/AppContext"
            }
          ],
          "exports": [],
          "functions": [
            "StreamingFunscriptController",
            "CHUNK_DURATION_MS",
            "CHUNK_MARGIN_MS",
            "CHUNK_SEND_INTERVAL_MS",
            "BUFFER_REPLACE_THRESHOLD_MS",
            "pendingCommandRef",
            "setPendingCommand",
            "timerGenerationRef",
            "streamingLockRef",
            "isPointGeneratorContentRef"
          ]
        },
        {
          "path": "src/components/Character/AutoblowController.js",
          "name": "AutoblowController.js (Future)",
          "lines": 0,
          "type": "controller",
          "imports": [],
          "exports": [
            "AutoblowController"
          ],
          "functions": []
        },
        {
          "path": "src/components/Character/LovenseController.js",
          "name": "LovenseController.js (Future)",
          "lines": 0,
          "type": "controller",
          "imports": [],
          "exports": [
            "LovenseController"
          ],
          "functions": []
        }
      ],
      "utils": []
    },
    "files": [
      {
        "path": "src/components/AudioChat/AudioChatNew.jsx",
        "name": "AudioChatNew.jsx",
        "lines": 441,
        "type": "component",
        "imports": [
          {
            "named": [
              "useParams",
              "useNavigate"
            ],
            "from": "react-router-dom"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../context/AppContext"
          },
          {
            "named": [
              "AudioChatProvider",
              "useAudioChat",
              "SpeechRecognitionProvider",
              "useSpeechRecognition",
              "TTSProvider",
              "useTTS",
              "DeviceControlProvider"
            ],
            "from": "./context"
          },
          {
            "named": [
              "useAIInference",
              "useCommandDetection",
              "useAutoContinuation",
              "usePaymentManagement",
              "useConversationInitializer"
            ],
            "from": "./hooks"
          },
          {
            "named": [
              "ChatLayout"
            ],
            "from": "./components/layout"
          },
          {
            "named": [
              "ModalSystem"
            ],
            "from": "./components/modals"
          },
          {
            "named": [],
            "default": "ElevenLabsIndicator",
            "from": "./components/indicators/ElevenLabsIndicator"
          }
        ],
        "exports": [],
        "functions": [
          "AudioChatCore",
          "navigate",
          "AudioChatWithCallbacks",
          "payment",
          "commandDetection",
          "aiInference",
          "autoContinuation",
          "handleSpeechDetected",
          "handleSpeechResult",
          "accessResult"
        ]
      },
      {
        "path": "src/components/AudioChat/AudioChatWrapper.jsx",
        "name": "AudioChatWrapper.jsx",
        "lines": 133,
        "type": "component",
        "imports": [
          {
            "named": [],
            "default": "React",
            "from": "react"
          },
          {
            "named": [],
            "default": "UncensoredAI_Audio",
            "from": "../UncensoredAudio/audio_uncensored_ai"
          },
          {
            "named": [],
            "default": "AudioChatNew",
            "from": "./AudioChatNew"
          }
        ],
        "exports": [
          "enableNewAudioChat",
          "disableNewAudioChat",
          "clearAudioChatOverride",
          "getAudioChatVersion"
        ],
        "functions": [
          "AudioChatWrapper",
          "useNewAudioChat",
          "localStorageOverride",
          "shouldUseNew",
          "enableNewAudioChat",
          "disableNewAudioChat",
          "clearAudioChatOverride",
          "getAudioChatVersion",
          "localStorageOverride",
          "useNewAudioChat"
        ]
      },
      {
        "path": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
        "name": "ChatInputArea.jsx",
        "lines": 332,
        "type": "component",
        "imports": [
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../../context/AppContext"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../../context/AudioChatProvider"
          },
          {
            "named": [
              "useTTS"
            ],
            "from": "../../context/TTSProvider"
          },
          {
            "named": [
              "useVoiceChat"
            ],
            "from": "../../hooks/useVoiceChat"
          },
          {
            "named": [
              "useAIInference"
            ],
            "from": "../../hooks/useAIInference"
          },
          {
            "named": [
              "useAutoContinuation"
            ],
            "from": "../../hooks/useAutoContinuation"
          },
          {
            "named": [
              "useCommandDetection"
            ],
            "from": "../../hooks/useCommandDetection"
          },
          {
            "named": [
              "usePaymentManagement"
            ],
            "from": "../../hooks/usePaymentManagement"
          },
          {
            "named": [
              "useDeviceControl"
            ],
            "from": "../../context/DeviceControlProvider"
          },
          {
            "named": [],
            "default": "UserInputSuggestions",
            "from": "../../../UncensoredAudio/UserInputSuggestions"
          },
          {
            "named": [],
            "default": "InChatImageGenV2",
            "from": "../../../ImageGeneration/InChatImageGenV2"
          },
          {
            "named": [],
            "default": "MobileTimeUnlock",
            "from": "../../../UncensoredAudio/MobileTimeUnlock"
          },
          {
            "named": [],
            "default": "MobileNeuralToggle",
            "from": "../../../UncensoredAudio/MobileNeuralToggle"
          }
        ],
        "exports": [],
        "functions": [
          "ChatInputArea",
          "payment",
          "charactersObj",
          "character",
          "conversation",
          "voiceChat",
          "aiInference",
          "autoContinuation",
          "commandDetection",
          "textareaRef"
        ]
      },
      {
        "path": "src/components/AudioChat/components/chat/ChatMessages.jsx",
        "name": "ChatMessages.jsx",
        "lines": 151,
        "type": "component",
        "imports": [
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../../context/AppContext"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../../context/AudioChatProvider"
          },
          {
            "named": [],
            "default": "MessageBubble",
            "from": "./MessageBubble"
          }
        ],
        "exports": [],
        "functions": [
          "ChatMessages",
          "messagesContainerRef",
          "hasScrolledOnceRef",
          "lastScrollHeightRef",
          "isNearBottomRef",
          "conversation",
          "charactersObj",
          "character",
          "container",
          "handleScroll"
        ]
      },
      {
        "path": "src/components/AudioChat/components/chat/CommandIndicators.jsx",
        "name": "CommandIndicators.jsx",
        "lines": 27,
        "type": "component",
        "imports": [
          {
            "named": [],
            "default": "React",
            "from": "react"
          }
        ],
        "exports": [],
        "functions": [
          "CommandIndicators"
        ]
      },
      {
        "path": "src/components/AudioChat/components/chat/FormattedMessageText.jsx",
        "name": "FormattedMessageText.jsx",
        "lines": 61,
        "type": "component",
        "imports": [
          {
            "named": [
              "parseMessageFormatting"
            ],
            "from": "../../utils/messageFormatting"
          }
        ],
        "exports": [],
        "functions": [
          "FormattedMessageText",
          "segments"
        ]
      },
      {
        "path": "src/components/AudioChat/components/chat/MessageBubble.jsx",
        "name": "MessageBubble.jsx",
        "lines": 297,
        "type": "component",
        "imports": [
          {
            "named": [],
            "default": "FormattedMessageText",
            "from": "./FormattedMessageText"
          },
          {
            "named": [],
            "default": "CommandIndicators",
            "from": "./CommandIndicators"
          },
          {
            "named": [
              "useTTS"
            ],
            "from": "../../context/TTSProvider"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../../context/AudioChatProvider"
          },
          {
            "named": [
              "useDeviceControl"
            ],
            "from": "../../context/DeviceControlProvider"
          },
          {
            "named": [
              "useAIInference"
            ],
            "from": "../../hooks/useAIInference"
          },
          {
            "named": [
              "usePaymentManagement"
            ],
            "from": "../../hooks/usePaymentManagement"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../../context/AppContext"
          },
          {
            "named": [
              "ConversationSummarizer"
            ],
            "from": "../../../Memory/MemoryInjectionComponent"
          },
          {
            "named": [
              "processMessageWithCommands",
              "formatTimestamp",
              "getMessageClassName",
              "isAssistantMessage"
            ],
            "from": "../../utils/messageFormatting"
          }
        ],
        "exports": [],
        "functions": [
          "arePropsEqual",
          "MessageBubbleComponent",
          "aiInference",
          "payment",
          "commandIndicators",
          "hasNoInput",
          "cleanedText",
          "charactersObj",
          "character",
          "conversation"
        ]
      },
      {
        "path": "src/components/AudioChat/components/chat/TimeDisplay.jsx",
        "name": "TimeDisplay.jsx",
        "lines": 56,
        "type": "component",
        "imports": [
          {
            "named": [],
            "default": "React",
            "from": "react"
          },
          {
            "named": [
              "usePaymentManagement"
            ],
            "from": "../../hooks/usePaymentManagement"
          }
        ],
        "exports": [],
        "functions": [
          "TimeDisplay",
          "payment",
          "status"
        ]
      },
      {
        "path": "src/components/AudioChat/components/chat/index.js",
        "name": "index.js",
        "lines": 12,
        "type": "component",
        "imports": [],
        "exports": [],
        "functions": []
      },
      {
        "path": "src/components/AudioChat/components/index.js",
        "name": "index.js",
        "lines": 17,
        "type": "component",
        "imports": [],
        "exports": [],
        "functions": []
      },
      {
        "path": "src/components/AudioChat/components/indicators/ElevenLabsIndicator.jsx",
        "name": "ElevenLabsIndicator.jsx",
        "lines": 134,
        "type": "component",
        "imports": [
          {
            "named": [
              "elevenLabsSessionController"
            ],
            "from": "../../services/ElevenLabsSessionController"
          }
        ],
        "exports": [],
        "functions": [
          "ElevenLabsIndicator",
          "interval"
        ]
      },
      {
        "path": "src/components/AudioChat/components/layout/ChatLayout.jsx",
        "name": "ChatLayout.jsx",
        "lines": 203,
        "type": "component",
        "imports": [
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../../context/AppContext"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../../context/AudioChatProvider"
          },
          {
            "named": [
              "useMemoryManagement"
            ],
            "from": "../../hooks/useMemoryManagement"
          },
          {
            "named": [
              "usePaymentManagement"
            ],
            "from": "../../hooks/usePaymentManagement"
          },
          {
            "named": [
              "useDeviceControl"
            ],
            "from": "../../context/DeviceControlProvider"
          },
          {
            "named": [],
            "default": "MobileHeader",
            "from": "./MobileHeader"
          },
          {
            "named": [],
            "default": "ChatMainContent",
            "from": "./ChatMainContent"
          },
          {
            "named": [],
            "default": "RightPanel",
            "from": "../../../UncensoredAudio/RightPanel"
          }
        ],
        "exports": [],
        "functions": [
          "SUPPORTED_MODELS",
          "ChatLayout",
          "memory",
          "payment",
          "effectiveFirmwareVersion",
          "isV4Firmware",
          "forceCommandAnalyzer",
          "usePointGenerator",
          "charactersObj",
          "character"
        ]
      },
      {
        "path": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
        "name": "ChatMainContent.jsx",
        "lines": 66,
        "type": "component",
        "imports": [
          {
            "named": [],
            "default": "React",
            "from": "react"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../../context/AppContext"
          },
          {
            "named": [],
            "default": "ChatMessages",
            "from": "../chat/ChatMessages"
          },
          {
            "named": [],
            "default": "ChatInputArea",
            "from": "../chat/ChatInputArea"
          },
          {
            "named": [],
            "default": "TimeDisplay",
            "from": "../chat/TimeDisplay"
          },
          {
            "named": [],
            "default": "BackgroundMedia",
            "from": "../../../shared/BackgroundMedia"
          },
          {
            "named": [
              "useDeviceControl"
            ],
            "from": "../../context/DeviceControlProvider"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../../context/AudioChatProvider"
          }
        ],
        "exports": [],
        "functions": [
          "ChatMainContent",
          "allCharacters",
          "character"
        ]
      },
      {
        "path": "src/components/AudioChat/components/layout/MobileHeader.jsx",
        "name": "MobileHeader.jsx",
        "lines": 81,
        "type": "component",
        "imports": [
          {
            "named": [
              "useNavigate"
            ],
            "from": "react-router-dom"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../../context/AppContext"
          }
        ],
        "exports": [],
        "functions": [
          "MobileHeader",
          "navigate",
          "allCharacters",
          "character",
          "handleVerticalNavToggle",
          "verticalNav",
          "handleViewCharacter"
        ]
      },
      {
        "path": "src/components/AudioChat/components/layout/index.js",
        "name": "index.js",
        "lines": 9,
        "type": "component",
        "imports": [],
        "exports": [],
        "functions": []
      },
      {
        "path": "src/components/AudioChat/components/modals/ModalSystem.jsx",
        "name": "ModalSystem.jsx",
        "lines": 394,
        "type": "component",
        "imports": [
          {
            "named": [
              "useNavigate"
            ],
            "from": "react-router-dom"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../../context/AppContext"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../../context/AudioChatProvider"
          },
          {
            "named": [
              "useVoiceChat"
            ],
            "from": "../../hooks/useVoiceChat"
          },
          {
            "named": [
              "usePaymentManagement"
            ],
            "from": "../../hooks/usePaymentManagement"
          },
          {
            "named": [
              "useCommandDetection"
            ],
            "from": "../../hooks/useCommandDetection"
          },
          {
            "named": [
              "useSpeechRecognition"
            ],
            "from": "../../context/SpeechRecognitionProvider"
          },
          {
            "named": [],
            "default": "GeminiLiveModal",
            "from": "../../../UncensoredAudio/GeminiLiveModal"
          },
          {
            "named": [],
            "default": "VoiceCallModal",
            "from": "../../../UncensoredAudio/VoiceCallModal"
          },
          {
            "named": [],
            "default": "PaymentModal",
            "from": "../../../PaymentModal"
          },
          {
            "named": [],
            "default": "TokensExhaustedModal",
            "from": "../../../modals/TokensExhaustedModal"
          }
        ],
        "exports": [],
        "functions": [
          "ModalSystem",
          "navigate",
          "payment",
          "voiceChat",
          "commandDetection",
          "charactersObj",
          "character",
          "handleRegularVoiceSelected",
          "handleCascadeVoiceSelected",
          "cascadeStatus"
        ]
      },
      {
        "path": "src/components/AudioChat/components/modals/index.js",
        "name": "index.js",
        "lines": 7,
        "type": "component",
        "imports": [],
        "exports": [],
        "functions": []
      },
      {
        "path": "src/components/AudioChat/context/AudioChatProvider.jsx",
        "name": "AudioChatProvider.jsx",
        "lines": 453,
        "type": "context",
        "imports": [
          {
            "named": [
              "settings"
            ],
            "from": "../services/settingsManager"
          },
          {
            "named": [
              "voiceSessionController"
            ],
            "from": "../services/VoiceSessionController"
          },
          {
            "named": [
              "elevenLabsSessionController"
            ],
            "from": "../services/ElevenLabsSessionController"
          }
        ],
        "exports": [
          "AudioChatProvider",
          "useAudioChat"
        ],
        "functions": [
          "AudioChatContext",
          "AudioChatProvider",
          "controller",
          "elevenLabsController",
          "oldValue",
          "newValue",
          "autoContinueTimeoutRef",
          "autoContinueIntervalRef",
          "onTTSCompleteRef",
          "onTTSStartRef"
        ]
      },
      {
        "path": "src/components/AudioChat/context/DeviceControlProvider.jsx",
        "name": "DeviceControlProvider.jsx",
        "lines": 295,
        "type": "context",
        "imports": [
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../context/AppContext"
          },
          {
            "named": [
              "calculateFunscriptDuration",
              "getControllerForFirmware",
              "isDeviceReady",
              "getDeviceStatus",
              "isValidFunscript",
              "parseFunscriptData",
              "getFunscriptMetadata"
            ],
            "from": "../services/deviceService"
          }
        ],
        "exports": [
          "DeviceControlProvider",
          "useDeviceControl"
        ],
        "functions": [
          "DeviceControlContext",
          "DeviceControlProvider",
          "funscriptTimeoutRef",
          "deviceReadyTimeoutRef",
          "movementPollingRef",
          "lastPositionRef",
          "movementDetectionStartTimeRef",
          "effectiveFirmwareVersion",
          "controllerName",
          "deviceReady"
        ]
      },
      {
        "path": "src/components/AudioChat/context/SpeechRecognitionProvider.jsx",
        "name": "SpeechRecognitionProvider.jsx",
        "lines": 319,
        "type": "context",
        "imports": [
          {
            "named": [
              "getMobileInfo",
              "checkSpeechRecognitionSupport",
              "initializeSpeechRecognition",
              "setupRecognitionHandlers",
              "getRecognitionRestartDelay"
            ],
            "from": "../services/speechRecognitionService"
          }
        ],
        "exports": [
          "SpeechRecognitionProvider",
          "useSpeechRecognition"
        ],
        "functions": [
          "SpeechRecognitionContext",
          "SpeechRecognitionProvider",
          "mobileInfo",
          "recognitionRef",
          "isRecognitionActiveRef",
          "currentTranscriptRef",
          "lastSpeechEndTimeRef",
          "selectedLanguageRef",
          "speechSubmissionTimerRef",
          "speechDetectedThisSessionRef"
        ]
      },
      {
        "path": "src/components/AudioChat/context/TTSProvider.jsx",
        "name": "TTSProvider.jsx",
        "lines": 272,
        "type": "context",
        "imports": [
          {
            "named": [
              "useAudioChat"
            ],
            "from": "./AudioChatProvider"
          },
          {
            "named": [
              "playGoogleTTS",
              "stopGoogleTTS",
              "processElevenLabsResponse",
              "stopElevenLabsTTS",
              "isElevenLabsActive",
              "cleanTextForTTS",
              "getTTSProvider"
            ],
            "from": "../services/ttsService"
          }
        ],
        "exports": [
          "TTSProvider",
          "useTTS"
        ],
        "functions": [
          "TTSContext",
          "TTSProvider",
          "currentAudioRef",
          "ttsPlayingRef",
          "speechInProgressRef",
          "playTTS",
          "ttsProvider",
          "cleanedText",
          "playGoogleTTSInternal",
          "localResponseId"
        ]
      },
      {
        "path": "src/components/AudioChat/context/index.js",
        "name": "index.js",
        "lines": 10,
        "type": "context",
        "imports": [],
        "exports": [],
        "functions": []
      },
      {
        "path": "src/components/AudioChat/hooks/index.js",
        "name": "index.js",
        "lines": 16,
        "type": "hook",
        "imports": [],
        "exports": [],
        "functions": []
      },
      {
        "path": "src/components/AudioChat/hooks/useAIInference.js",
        "name": "useAIInference.js",
        "lines": 405,
        "type": "hook",
        "imports": [
          {
            "named": [
              "useState",
              "useCallback",
              "useRef"
            ],
            "from": "react"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../context/AppContext"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../context/AudioChatProvider"
          },
          {
            "named": [
              "useMemoryManagement"
            ],
            "from": "./useMemoryManagement"
          },
          {
            "named": [
              "buildConversationHistory",
              "streamAIResponse",
              "getLengthInstruction",
              "getNSFWRoleplayInstruction"
            ],
            "from": "../services/aiService"
          },
          {
            "named": [
              "saveToEnhancedConversation",
              "getEnhancedConversation"
            ],
            "from": "../services/enhancedConversationService"
          },
          {
            "named": [
              "injectContentSafetyIfNeeded"
            ],
            "from": "../services/contentSafetyService"
          }
        ],
        "exports": [
          "useAIInference"
        ],
        "functions": [
          "useAIInference",
          "memory",
          "memoryPrompt",
          "getCharacter",
          "charactersObj",
          "sendMessage",
          "executeDetectedCommand",
          "accessResult",
          "unlockResult",
          "responseId"
        ]
      },
      {
        "path": "src/components/AudioChat/hooks/useAutoContinuation.js",
        "name": "useAutoContinuation.js",
        "lines": 160,
        "type": "hook",
        "imports": [
          {
            "named": [
              "useState",
              "useRef",
              "useCallback",
              "useEffect"
            ],
            "from": "react"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../context/AudioChatProvider"
          }
        ],
        "exports": [
          "useAutoContinuation"
        ],
        "functions": [
          "useAutoContinuation",
          "onContinueRef",
          "start",
          "delay",
          "newValue",
          "cancel",
          "reset",
          "shouldAutoContinue",
          "handleNoInputDetected"
        ]
      },
      {
        "path": "src/components/AudioChat/hooks/useCommandDetection.js",
        "name": "useCommandDetection.js",
        "lines": 294,
        "type": "hook",
        "imports": [
          {
            "named": [
              "useState",
              "useCallback",
              "useRef"
            ],
            "from": "react"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../context/AppContext"
          },
          {
            "named": [
              "useDeviceControl"
            ],
            "from": "../context/DeviceControlProvider"
          },
          {
            "named": [
              "useTrainingData"
            ],
            "from": "../../../context/TrainingDataContext"
          },
          {
            "named": [
              "detectAndExecuteCommands",
              "hasNoInputCommand",
              "extractCommandIndicators",
              "applyCommandCustomizations",
              "getAvailableCommands"
            ],
            "from": "../services/commandService"
          },
          {
            "named": [
              "fetchFavoritePatterns"
            ],
            "from": "../services/enhancedConversationService"
          },
          {
            "named": [
              "commandAnalyzer"
            ],
            "from": "../../SecondaryLLM/CommandAnalyzer"
          },
          {
            "named": [],
            "default": "PointGenerator",
            "from": "../../SecondaryLLM/PointGenerator"
          }
        ],
        "exports": [
          "useCommandDetection"
        ],
        "functions": [
          "useCommandDetection",
          "trainingDataLogger",
          "pointGeneratorRef",
          "getCharacter",
          "charactersObj",
          "detectCommands",
          "hasNoInputCmd",
          "character",
          "conversationHistory",
          "recentHistory"
        ]
      },
      {
        "path": "src/components/AudioChat/hooks/useConversationInitializer.js",
        "name": "useConversationInitializer.js",
        "lines": 139,
        "type": "hook",
        "imports": [
          {
            "named": [
              "useEffect",
              "useState",
              "useRef"
            ],
            "from": "react"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../context/AppContext"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../context/AudioChatProvider"
          },
          {
            "named": [
              "getEnhancedConversation"
            ],
            "from": "../services/enhancedConversationService"
          }
        ],
        "exports": [
          "useConversationInitializer"
        ],
        "functions": [
          "loadingCharacters",
          "useConversationInitializer",
          "existingConversation",
          "initializeConversation",
          "enhanced",
          "conversation",
          "temporal",
          "reloadConversation"
        ]
      },
      {
        "path": "src/components/AudioChat/hooks/useImageGeneration.js",
        "name": "useImageGeneration.js",
        "lines": 167,
        "type": "hook",
        "imports": [
          {
            "named": [
              "useCallback"
            ],
            "from": "react"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../context/AudioChatProvider"
          }
        ],
        "exports": [
          "useImageGeneration"
        ],
        "functions": [
          "useImageGeneration",
          "setProvider",
          "setStyle",
          "setQuality",
          "setNegativePrompt",
          "startGeneration",
          "completeGeneration",
          "cancelGeneration",
          "viewImage",
          "closeImageModal"
        ]
      },
      {
        "path": "src/components/AudioChat/hooks/useMemoryManagement.js",
        "name": "useMemoryManagement.js",
        "lines": 162,
        "type": "hook",
        "imports": [
          {
            "named": [
              "useCallback",
              "useEffect",
              "useMemo"
            ],
            "from": "react"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../context/AudioChatProvider"
          },
          {
            "named": [
              "useMemoryInjection"
            ],
            "from": "../../Memory/MemoryInjectionComponent"
          }
        ],
        "exports": [
          "useMemoryManagement"
        ],
        "functions": [
          "useMemoryManagement",
          "toggleSentientMode",
          "currentValue",
          "newValue",
          "enableSentientMode",
          "disableSentientMode",
          "refresh",
          "getMemoryStats",
          "shouldInjectMemory",
          "getSessionDurationMinutes"
        ]
      },
      {
        "path": "src/components/AudioChat/hooks/useMobileSpeechRecognition.js",
        "name": "useMobileSpeechRecognition.js",
        "lines": 153,
        "type": "hook",
        "imports": [
          {
            "named": [
              "useCallback",
              "useMemo"
            ],
            "from": "react"
          },
          {
            "named": [
              "useSpeechRecognition"
            ],
            "from": "../context/SpeechRecognitionProvider"
          },
          {
            "named": [
              "getSpeechRecognitionErrorMessage"
            ],
            "from": "../services/speechRecognitionService"
          }
        ],
        "exports": [
          "useMobileSpeechRecognition"
        ],
        "functions": [
          "useMobileSpeechRecognition",
          "getErrorMessage",
          "hasGoodSupport",
          "getInstructions",
          "getRecognitionMode",
          "startWithDelay",
          "shouldShowInterim",
          "getPlatformDebugInfo"
        ]
      },
      {
        "path": "src/components/AudioChat/hooks/usePaymentManagement.js",
        "name": "usePaymentManagement.js",
        "lines": 455,
        "type": "hook",
        "imports": [
          {
            "named": [
              "useState",
              "useEffect",
              "useCallback",
              "useRef"
            ],
            "from": "react"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../context/AppContext"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../context/AudioChatProvider"
          },
          {
            "named": [
              "calculateRemainingTime",
              "checkAccess",
              "shouldShowExtensionModal",
              "shouldPulseTimeButton",
              "unlockTime",
              "attemptAutoUnlock",
              "getRemainingFreeMessages as getRemainingFreeMessagesUtil",
              "formatRemainingTime",
              "getTimeStatus",
              "shouldDecrementFreeMessage",
              "getTimeUnlockConfig"
            ],
            "from": "../services/paymentService"
          }
        ],
        "exports": [
          "usePaymentManagement"
        ],
        "functions": [
          "usePaymentManagement",
          "intervalIdRef",
          "extensionModalShownRef",
          "cascadeIntervalIdRef",
          "config",
          "isCurrentCharacterFree",
          "updateTimeTracking",
          "timeLeft",
          "updateFreeMessageTracking",
          "freeMessages"
        ]
      },
      {
        "path": "src/components/AudioChat/hooks/useTrainingDataCollection.js",
        "name": "useTrainingDataCollection.js",
        "lines": 86,
        "type": "hook",
        "imports": [
          {
            "named": [
              "useCallback"
            ],
            "from": "react"
          },
          {
            "named": [
              "useTrainingData"
            ],
            "from": "../../../context/TrainingDataContext"
          }
        ],
        "exports": [
          "useTrainingDataCollection"
        ],
        "functions": [
          "useTrainingDataCollection",
          "trainingDataLogger",
          "logPointGeneratorData",
          "logCommandAnalyzerData",
          "isEnabled",
          "getLogger"
        ]
      },
      {
        "path": "src/components/AudioChat/hooks/useVoiceChat.js",
        "name": "useVoiceChat.js",
        "lines": 211,
        "type": "hook",
        "imports": [
          {
            "named": [
              "useCallback"
            ],
            "from": "react"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../../context/AppContext"
          },
          {
            "named": [
              "useAudioChat"
            ],
            "from": "../context/AudioChatProvider"
          },
          {
            "named": [
              "useSpeechRecognition"
            ],
            "from": "../context/SpeechRecognitionProvider"
          },
          {
            "named": [
              "useTTS"
            ],
            "from": "../context/TTSProvider"
          },
          {
            "named": [
              "useDeviceControl"
            ],
            "from": "../context/DeviceControlProvider"
          },
          {
            "named": [
              "requestMicrophonePermission"
            ],
            "from": "../services/speechRecognitionService"
          },
          {
            "named": [
              "requestAutoplayPermission",
              "resumeAudioContext"
            ],
            "from": "../services/ttsService"
          },
          {
            "named": [
              "elevenLabsSessionController"
            ],
            "from": "../services/ElevenLabsSessionController"
          }
        ],
        "exports": [
          "useVoiceChat"
        ],
        "functions": [
          "useVoiceChat",
          "startSession",
          "accessResult",
          "hasMicPermission",
          "stopSession",
          "toggleSession",
          "canStartSession",
          "getSessionStatus"
        ]
      },
      {
        "path": "src/components/AudioChat/index.js",
        "name": "index.js",
        "lines": 30,
        "type": "component",
        "imports": [],
        "exports": [],
        "functions": []
      },
      {
        "path": "src/components/AudioChat/services/ElevenLabsSessionController.js",
        "name": "ElevenLabsSessionController.js",
        "lines": 982,
        "type": "service",
        "imports": [],
        "exports": [
          "elevenLabsSessionController"
        ],
        "functions": [
          "checkResponse",
          "checkData",
          "response",
          "data",
          "AudioContext",
          "contextOptions",
          "storedCustomization",
          "requestBody",
          "response",
          "data"
        ]
      },
      {
        "path": "src/components/AudioChat/services/VoiceSessionController.js",
        "name": "VoiceSessionController.js",
        "lines": 262,
        "type": "service",
        "imports": [],
        "exports": [
          "voiceSessionController"
        ],
        "functions": [
          "voiceSessionController"
        ]
      },
      {
        "path": "src/components/AudioChat/services/aiService.js",
        "name": "aiService.js",
        "lines": 315,
        "type": "service",
        "imports": [],
        "exports": [
          "trimConversation",
          "buildConversationHistory",
          "streamAIResponse",
          "estimateTokenCount",
          "calculateConversationTokens",
          "getLengthInstruction",
          "getNSFWRoleplayInstruction"
        ],
        "functions": [
          "ESTIMATED_TOKENS_PER_WORD",
          "MAX_INPUT_TOKENS",
          "STREAMING_THROTTLE_MS",
          "createThrottle",
          "now",
          "timeSinceLastCall",
          "trimConversation",
          "trimmed",
          "msg",
          "msgTokens"
        ]
      },
      {
        "path": "src/components/AudioChat/services/commandService.js",
        "name": "commandService.js",
        "lines": 337,
        "type": "service",
        "imports": [],
        "exports": [
          "analyzeWithPointGenerator",
          "analyzeWithCommandAnalyzer",
          "getAvailableCommands",
          "applyCommandCustomizations",
          "hasNoInputCommand",
          "extractCommandIndicators",
          "removeCommandMarkers",
          "getDetectionSystem",
          "detectAndExecuteCommands"
        ],
        "functions": [
          "analyzeWithPointGenerator",
          "pg",
          "result",
          "funscriptData",
          "analyzeWithCommandAnalyzer",
          "ca",
          "result",
          "commandData",
          "getAvailableCommands",
          "buildCommandMappingFromAdapter"
        ]
      },
      {
        "path": "src/components/AudioChat/services/contentSafetyService.js",
        "name": "contentSafetyService.js",
        "lines": 78,
        "type": "service",
        "imports": [],
        "exports": [
          "getElevenLabsContentSafetyRules",
          "injectContentSafetyIfNeeded",
          "checkElevenLabsActive",
          "getContentSafetyStatus"
        ],
        "functions": [
          "getElevenLabsContentSafetyRules",
          "injectContentSafetyIfNeeded",
          "checkElevenLabsActive",
          "getContentSafetyStatus"
        ]
      },
      {
        "path": "src/components/AudioChat/services/deviceService.js",
        "name": "deviceService.js",
        "lines": 280,
        "type": "service",
        "imports": [],
        "exports": [
          "calculateFunscriptDuration",
          "executeFunscriptCommand",
          "stopDevice",
          "globalStopAllFunscripts",
          "isDeviceConnected",
          "getControllerForFirmware",
          "getHandyConnectionKey",
          "isValidFunscript",
          "parseFunscriptData",
          "getFunscriptMetadata",
          "createVisualizationData",
          "isDeviceReady",
          "getDeviceStatus"
        ],
        "functions": [
          "calculateFunscriptDuration",
          "lastAction",
          "executeFunscriptCommand",
          "stopDevice",
          "globalStopAllFunscripts",
          "isDeviceConnected",
          "getControllerForFirmware",
          "effectiveVersion",
          "versionNumber",
          "getHandyConnectionKey"
        ]
      },
      {
        "path": "src/components/AudioChat/services/enhancedConversationService.js",
        "name": "enhancedConversationService.js",
        "lines": 189,
        "type": "service",
        "imports": [],
        "exports": [
          "initializeEnhancedSession",
          "saveToEnhancedConversation",
          "getEnhancedConversation",
          "fetchFavoritePatterns",
          "selectBestConversation",
          "calculateConversationTier",
          "getTierDescription"
        ],
        "functions": [
          "initializeEnhancedSession",
          "backendURL",
          "response",
          "data",
          "saveToEnhancedConversation",
          "backendURL",
          "response",
          "data",
          "getEnhancedConversation",
          "backendURL"
        ]
      },
      {
        "path": "src/components/AudioChat/services/index.js",
        "name": "index.js",
        "lines": 15,
        "type": "service",
        "imports": [],
        "exports": [],
        "functions": []
      },
      {
        "path": "src/components/AudioChat/services/paymentService.js",
        "name": "paymentService.js",
        "lines": 320,
        "type": "service",
        "imports": [],
        "exports": [
          "calculateRemainingTime",
          "checkAccess",
          "shouldShowExtensionModal",
          "shouldPulseTimeButton",
          "unlockTime",
          "attemptAutoUnlock",
          "getRemainingFreeMessages",
          "formatRemainingTime",
          "getTimeStatus",
          "shouldDecrementFreeMessage",
          "getTimeUnlockConfig"
        ],
        "functions": [
          "calculateRemainingTime",
          "now",
          "expiryTime",
          "diffMs",
          "diffMinutes",
          "checkAccess",
          "hasAccess",
          "shouldShowExtensionModal",
          "shouldPulseTimeButton",
          "unlockTime"
        ]
      },
      {
        "path": "src/components/AudioChat/services/settingsManager.js",
        "name": "settingsManager.js",
        "lines": 199,
        "type": "service",
        "imports": [],
        "exports": [
          "settings"
        ],
        "functions": [
          "SETTINGS_DEFAULTS",
          "saved",
          "stored",
          "defaultValue",
          "settings",
          "settings",
          "eventName",
          "handler",
          "event",
          "settings"
        ]
      },
      {
        "path": "src/components/AudioChat/services/speechRecognitionService.js",
        "name": "speechRecognitionService.js",
        "lines": 195,
        "type": "service",
        "imports": [],
        "exports": [
          "getMobileInfo",
          "isMobile",
          "checkSpeechRecognitionSupport",
          "initializeSpeechRecognition",
          "setupRecognitionHandlers",
          "requestMicrophonePermission",
          "getSpeechRecognitionErrorMessage",
          "getRecognitionRestartDelay"
        ],
        "functions": [
          "getMobileInfo",
          "userAgent",
          "isMobile",
          "isIOS",
          "isChrome",
          "isSafari",
          "isFirefox",
          "isMobile",
          "checkSpeechRecognitionSupport",
          "hasWebkitSpeechRecognition"
        ]
      },
      {
        "path": "src/components/AudioChat/services/ttsService.js",
        "name": "ttsService.js",
        "lines": 258,
        "type": "service",
        "imports": [],
        "exports": [
          "playGoogleTTS",
          "stopGoogleTTS",
          "isElevenLabsActive",
          "processElevenLabsResponse",
          "stopElevenLabsTTS",
          "cleanTextForTTS",
          "splitIntoSentences",
          "getTTSProvider",
          "fetchAvailableVoices",
          "getOrCreateAudioContext",
          "resumeAudioContext",
          "requestAutoplayPermission"
        ],
        "functions": [
          "playGoogleTTS",
          "backendURL",
          "response",
          "audioBlob",
          "audioUrl",
          "audio",
          "playPromise",
          "stopGoogleTTS",
          "isElevenLabsActive",
          "processElevenLabsResponse"
        ]
      },
      {
        "path": "src/components/AudioChat/utils/index.js",
        "name": "index.js",
        "lines": 7,
        "type": "component",
        "imports": [],
        "exports": [],
        "functions": []
      },
      {
        "path": "src/components/AudioChat/utils/messageFormatting.js",
        "name": "messageFormatting.js",
        "lines": 225,
        "type": "component",
        "imports": [],
        "exports": [
          "processMessageWithCommands",
          "formatTimestamp",
          "parseMessageFormatting",
          "getMessageStats",
          "truncateText",
          "removeNarration",
          "extractDialogue",
          "isUserMessage",
          "isAssistantMessage",
          "getMessageClassName"
        ],
        "functions": [
          "processMessageWithCommands",
          "commandPattern",
          "commandIndicators",
          "commandName",
          "hasNoInput",
          "formatTimestamp",
          "date",
          "hours",
          "minutes",
          "parseMessageFormatting"
        ]
      },
      {
        "path": "src/components/Character/FunscriptController.js",
        "name": "FunscriptController.js",
        "lines": 1158,
        "type": "controller",
        "imports": [
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../context/AppContext"
          }
        ],
        "exports": [],
        "functions": [
          "newHandy",
          "connectIfNeeded",
          "startPlaybackMonitoring",
          "interval",
          "elapsed",
          "remaining",
          "handlePlaybackEnded",
          "stopPlaybackMonitoring",
          "restartCurrentFunscript",
          "restartCurrentFunscriptWithFullProcess"
        ]
      },
      {
        "path": "src/components/Character/HsspFunscriptController.js",
        "name": "HsspFunscriptController.js",
        "lines": 812,
        "type": "controller",
        "imports": [
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../context/AppContext"
          }
        ],
        "exports": [],
        "functions": [
          "effectiveFirmwareVersion",
          "isV4OrHigher",
          "isV3OrHigher",
          "newHandy",
          "connectIfNeeded",
          "calculateFunscriptDuration",
          "script",
          "metadataDuration",
          "actions",
          "lastAction"
        ]
      },
      {
        "path": "src/components/Character/StreamingFunscriptController.js",
        "name": "StreamingFunscriptController.js",
        "lines": 1922,
        "type": "controller",
        "imports": [
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../context/AppContext"
          }
        ],
        "exports": [],
        "functions": [
          "StreamingFunscriptController",
          "CHUNK_DURATION_MS",
          "CHUNK_MARGIN_MS",
          "CHUNK_SEND_INTERVAL_MS",
          "BUFFER_REPLACE_THRESHOLD_MS",
          "pendingCommandRef",
          "setPendingCommand",
          "timerGenerationRef",
          "streamingLockRef",
          "isPointGeneratorContentRef"
        ]
      },
      {
        "path": "src/pages/AdapterSettings.js",
        "name": "AdapterSettings.js",
        "lines": 1826,
        "type": "component",
        "imports": [
          {
            "named": [
              "useNavigate"
            ],
            "from": "react-router-dom"
          },
          {
            "named": [
              "useAppContext"
            ],
            "from": "../context/AppContext"
          },
          {
            "named": [],
            "default": "axios",
            "from": "axios"
          },
          {
            "named": [],
            "default": "FunscriptGraphViewer",
            "from": "../components/graphUI/FunscriptGraphViewer"
          },
          {
            "named": [],
            "default": "AdapterCard",
            "from": "../components/AdapterSettings/AdapterCard"
          },
          {
            "named": [
              "getBlurredCharacterBackground"
            ],
            "from": "../utils/characterBackgrounds"
          }
        ],
        "exports": [],
        "functions": [
          "AdapterSettings",
          "navigate",
          "fileInputRefs",
          "backendURL",
          "formatRelativeTime",
          "date",
          "now",
          "diffMs",
          "diffSecs",
          "diffMins"
        ]
      },
      {
        "path": "src/components/AdapterSettings/AdapterCard.js",
        "name": "AdapterCard.js",
        "lines": 120,
        "type": "component",
        "imports": [
          {
            "named": [],
            "default": "React",
            "from": "react"
          }
        ],
        "exports": [],
        "functions": [
          "AdapterCard",
          "formatSize",
          "getStatusColor",
          "getStatusLabel"
        ]
      },
      {
        "path": "src/components/AdminComponents/CommandCollectionManager.js",
        "name": "CommandCollectionManager.js",
        "lines": 953,
        "type": "component",
        "imports": [
          {
            "named": [
              "useAppContext"
            ],
            "from": "../../context/AppContext"
          },
          {
            "named": [],
            "default": "FunscriptGraphViewer",
            "from": "../graphUI/FunscriptGraphViewer"
          }
        ],
        "exports": [],
        "functions": [
          "CommandCollectionManager",
          "fileInputRef",
          "funscriptInputRefs",
          "backendURL",
          "fetchCollections",
          "response",
          "data",
          "handleCreateCollection",
          "response",
          "data"
        ]
      }
    ],
    "graph": {
      "nodes": [
        {
          "id": "src/components/AudioChat/AudioChatNew.jsx",
          "name": "AudioChatNew.jsx",
          "lines": 441,
          "type": "component",
          "exports": [],
          "functions": [
            "AudioChatCore",
            "navigate",
            "AudioChatWithCallbacks",
            "payment",
            "commandDetection",
            "aiInference",
            "autoContinuation",
            "handleSpeechDetected",
            "handleSpeechResult",
            "accessResult"
          ]
        },
        {
          "id": "src/components/AudioChat/AudioChatWrapper.jsx",
          "name": "AudioChatWrapper.jsx",
          "lines": 133,
          "type": "component",
          "exports": [
            "enableNewAudioChat",
            "disableNewAudioChat",
            "clearAudioChatOverride",
            "getAudioChatVersion"
          ],
          "functions": [
            "AudioChatWrapper",
            "useNewAudioChat",
            "localStorageOverride",
            "shouldUseNew",
            "enableNewAudioChat",
            "disableNewAudioChat",
            "clearAudioChatOverride",
            "getAudioChatVersion",
            "localStorageOverride",
            "useNewAudioChat"
          ]
        },
        {
          "id": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "name": "ChatInputArea.jsx",
          "lines": 332,
          "type": "component",
          "exports": [],
          "functions": [
            "ChatInputArea",
            "payment",
            "charactersObj",
            "character",
            "conversation",
            "voiceChat",
            "aiInference",
            "autoContinuation",
            "commandDetection",
            "textareaRef"
          ]
        },
        {
          "id": "src/components/AudioChat/components/chat/ChatMessages.jsx",
          "name": "ChatMessages.jsx",
          "lines": 151,
          "type": "component",
          "exports": [],
          "functions": [
            "ChatMessages",
            "messagesContainerRef",
            "hasScrolledOnceRef",
            "lastScrollHeightRef",
            "isNearBottomRef",
            "conversation",
            "charactersObj",
            "character",
            "container",
            "handleScroll"
          ]
        },
        {
          "id": "src/components/AudioChat/components/chat/CommandIndicators.jsx",
          "name": "CommandIndicators.jsx",
          "lines": 27,
          "type": "component",
          "exports": [],
          "functions": [
            "CommandIndicators"
          ]
        },
        {
          "id": "src/components/AudioChat/components/chat/FormattedMessageText.jsx",
          "name": "FormattedMessageText.jsx",
          "lines": 61,
          "type": "component",
          "exports": [],
          "functions": [
            "FormattedMessageText",
            "segments"
          ]
        },
        {
          "id": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "name": "MessageBubble.jsx",
          "lines": 297,
          "type": "component",
          "exports": [],
          "functions": [
            "arePropsEqual",
            "MessageBubbleComponent",
            "aiInference",
            "payment",
            "commandIndicators",
            "hasNoInput",
            "cleanedText",
            "charactersObj",
            "character",
            "conversation"
          ]
        },
        {
          "id": "src/components/AudioChat/components/chat/TimeDisplay.jsx",
          "name": "TimeDisplay.jsx",
          "lines": 56,
          "type": "component",
          "exports": [],
          "functions": [
            "TimeDisplay",
            "payment",
            "status"
          ]
        },
        {
          "id": "src/components/AudioChat/components/chat/index.js",
          "name": "index.js",
          "lines": 12,
          "type": "component",
          "exports": [],
          "functions": []
        },
        {
          "id": "src/components/AudioChat/components/index.js",
          "name": "index.js",
          "lines": 17,
          "type": "component",
          "exports": [],
          "functions": []
        },
        {
          "id": "src/components/AudioChat/components/indicators/ElevenLabsIndicator.jsx",
          "name": "ElevenLabsIndicator.jsx",
          "lines": 134,
          "type": "component",
          "exports": [],
          "functions": [
            "ElevenLabsIndicator",
            "interval"
          ]
        },
        {
          "id": "src/components/AudioChat/components/layout/ChatLayout.jsx",
          "name": "ChatLayout.jsx",
          "lines": 203,
          "type": "component",
          "exports": [],
          "functions": [
            "SUPPORTED_MODELS",
            "ChatLayout",
            "memory",
            "payment",
            "effectiveFirmwareVersion",
            "isV4Firmware",
            "forceCommandAnalyzer",
            "usePointGenerator",
            "charactersObj",
            "character"
          ]
        },
        {
          "id": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
          "name": "ChatMainContent.jsx",
          "lines": 66,
          "type": "component",
          "exports": [],
          "functions": [
            "ChatMainContent",
            "allCharacters",
            "character"
          ]
        },
        {
          "id": "src/components/AudioChat/components/layout/MobileHeader.jsx",
          "name": "MobileHeader.jsx",
          "lines": 81,
          "type": "component",
          "exports": [],
          "functions": [
            "MobileHeader",
            "navigate",
            "allCharacters",
            "character",
            "handleVerticalNavToggle",
            "verticalNav",
            "handleViewCharacter"
          ]
        },
        {
          "id": "src/components/AudioChat/components/layout/index.js",
          "name": "index.js",
          "lines": 9,
          "type": "component",
          "exports": [],
          "functions": []
        },
        {
          "id": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "name": "ModalSystem.jsx",
          "lines": 394,
          "type": "component",
          "exports": [],
          "functions": [
            "ModalSystem",
            "navigate",
            "payment",
            "voiceChat",
            "commandDetection",
            "charactersObj",
            "character",
            "handleRegularVoiceSelected",
            "handleCascadeVoiceSelected",
            "cascadeStatus"
          ]
        },
        {
          "id": "src/components/AudioChat/components/modals/index.js",
          "name": "index.js",
          "lines": 7,
          "type": "component",
          "exports": [],
          "functions": []
        },
        {
          "id": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "name": "AudioChatProvider.jsx",
          "lines": 453,
          "type": "context",
          "exports": [
            "AudioChatProvider",
            "useAudioChat"
          ],
          "functions": [
            "AudioChatContext",
            "AudioChatProvider",
            "controller",
            "elevenLabsController",
            "oldValue",
            "newValue",
            "autoContinueTimeoutRef",
            "autoContinueIntervalRef",
            "onTTSCompleteRef",
            "onTTSStartRef"
          ]
        },
        {
          "id": "src/components/AudioChat/context/DeviceControlProvider.jsx",
          "name": "DeviceControlProvider.jsx",
          "lines": 295,
          "type": "context",
          "exports": [
            "DeviceControlProvider",
            "useDeviceControl"
          ],
          "functions": [
            "DeviceControlContext",
            "DeviceControlProvider",
            "funscriptTimeoutRef",
            "deviceReadyTimeoutRef",
            "movementPollingRef",
            "lastPositionRef",
            "movementDetectionStartTimeRef",
            "effectiveFirmwareVersion",
            "controllerName",
            "deviceReady"
          ]
        },
        {
          "id": "src/components/AudioChat/context/SpeechRecognitionProvider.jsx",
          "name": "SpeechRecognitionProvider.jsx",
          "lines": 319,
          "type": "context",
          "exports": [
            "SpeechRecognitionProvider",
            "useSpeechRecognition"
          ],
          "functions": [
            "SpeechRecognitionContext",
            "SpeechRecognitionProvider",
            "mobileInfo",
            "recognitionRef",
            "isRecognitionActiveRef",
            "currentTranscriptRef",
            "lastSpeechEndTimeRef",
            "selectedLanguageRef",
            "speechSubmissionTimerRef",
            "speechDetectedThisSessionRef"
          ]
        },
        {
          "id": "src/components/AudioChat/context/TTSProvider.jsx",
          "name": "TTSProvider.jsx",
          "lines": 272,
          "type": "context",
          "exports": [
            "TTSProvider",
            "useTTS"
          ],
          "functions": [
            "TTSContext",
            "TTSProvider",
            "currentAudioRef",
            "ttsPlayingRef",
            "speechInProgressRef",
            "playTTS",
            "ttsProvider",
            "cleanedText",
            "playGoogleTTSInternal",
            "localResponseId"
          ]
        },
        {
          "id": "src/components/AudioChat/context/index.js",
          "name": "index.js",
          "lines": 10,
          "type": "context",
          "exports": [],
          "functions": []
        },
        {
          "id": "src/components/AudioChat/hooks/index.js",
          "name": "index.js",
          "lines": 16,
          "type": "hook",
          "exports": [],
          "functions": []
        },
        {
          "id": "src/components/AudioChat/hooks/useAIInference.js",
          "name": "useAIInference.js",
          "lines": 405,
          "type": "hook",
          "exports": [
            "useAIInference"
          ],
          "functions": [
            "useAIInference",
            "memory",
            "memoryPrompt",
            "getCharacter",
            "charactersObj",
            "sendMessage",
            "executeDetectedCommand",
            "accessResult",
            "unlockResult",
            "responseId"
          ]
        },
        {
          "id": "src/components/AudioChat/hooks/useAutoContinuation.js",
          "name": "useAutoContinuation.js",
          "lines": 160,
          "type": "hook",
          "exports": [
            "useAutoContinuation"
          ],
          "functions": [
            "useAutoContinuation",
            "onContinueRef",
            "start",
            "delay",
            "newValue",
            "cancel",
            "reset",
            "shouldAutoContinue",
            "handleNoInputDetected"
          ]
        },
        {
          "id": "src/components/AudioChat/hooks/useCommandDetection.js",
          "name": "useCommandDetection.js",
          "lines": 294,
          "type": "hook",
          "exports": [
            "useCommandDetection"
          ],
          "functions": [
            "useCommandDetection",
            "trainingDataLogger",
            "pointGeneratorRef",
            "getCharacter",
            "charactersObj",
            "detectCommands",
            "hasNoInputCmd",
            "character",
            "conversationHistory",
            "recentHistory"
          ]
        },
        {
          "id": "src/components/AudioChat/hooks/useConversationInitializer.js",
          "name": "useConversationInitializer.js",
          "lines": 139,
          "type": "hook",
          "exports": [
            "useConversationInitializer"
          ],
          "functions": [
            "loadingCharacters",
            "useConversationInitializer",
            "existingConversation",
            "initializeConversation",
            "enhanced",
            "conversation",
            "temporal",
            "reloadConversation"
          ]
        },
        {
          "id": "src/components/AudioChat/hooks/useImageGeneration.js",
          "name": "useImageGeneration.js",
          "lines": 167,
          "type": "hook",
          "exports": [
            "useImageGeneration"
          ],
          "functions": [
            "useImageGeneration",
            "setProvider",
            "setStyle",
            "setQuality",
            "setNegativePrompt",
            "startGeneration",
            "completeGeneration",
            "cancelGeneration",
            "viewImage",
            "closeImageModal"
          ]
        },
        {
          "id": "src/components/AudioChat/hooks/useMemoryManagement.js",
          "name": "useMemoryManagement.js",
          "lines": 162,
          "type": "hook",
          "exports": [
            "useMemoryManagement"
          ],
          "functions": [
            "useMemoryManagement",
            "toggleSentientMode",
            "currentValue",
            "newValue",
            "enableSentientMode",
            "disableSentientMode",
            "refresh",
            "getMemoryStats",
            "shouldInjectMemory",
            "getSessionDurationMinutes"
          ]
        },
        {
          "id": "src/components/AudioChat/hooks/useMobileSpeechRecognition.js",
          "name": "useMobileSpeechRecognition.js",
          "lines": 153,
          "type": "hook",
          "exports": [
            "useMobileSpeechRecognition"
          ],
          "functions": [
            "useMobileSpeechRecognition",
            "getErrorMessage",
            "hasGoodSupport",
            "getInstructions",
            "getRecognitionMode",
            "startWithDelay",
            "shouldShowInterim",
            "getPlatformDebugInfo"
          ]
        },
        {
          "id": "src/components/AudioChat/hooks/usePaymentManagement.js",
          "name": "usePaymentManagement.js",
          "lines": 455,
          "type": "hook",
          "exports": [
            "usePaymentManagement"
          ],
          "functions": [
            "usePaymentManagement",
            "intervalIdRef",
            "extensionModalShownRef",
            "cascadeIntervalIdRef",
            "config",
            "isCurrentCharacterFree",
            "updateTimeTracking",
            "timeLeft",
            "updateFreeMessageTracking",
            "freeMessages"
          ]
        },
        {
          "id": "src/components/AudioChat/hooks/useTrainingDataCollection.js",
          "name": "useTrainingDataCollection.js",
          "lines": 86,
          "type": "hook",
          "exports": [
            "useTrainingDataCollection"
          ],
          "functions": [
            "useTrainingDataCollection",
            "trainingDataLogger",
            "logPointGeneratorData",
            "logCommandAnalyzerData",
            "isEnabled",
            "getLogger"
          ]
        },
        {
          "id": "src/components/AudioChat/hooks/useVoiceChat.js",
          "name": "useVoiceChat.js",
          "lines": 211,
          "type": "hook",
          "exports": [
            "useVoiceChat"
          ],
          "functions": [
            "useVoiceChat",
            "startSession",
            "accessResult",
            "hasMicPermission",
            "stopSession",
            "toggleSession",
            "canStartSession",
            "getSessionStatus"
          ]
        },
        {
          "id": "src/components/AudioChat/index.js",
          "name": "index.js",
          "lines": 30,
          "type": "component",
          "exports": [],
          "functions": []
        },
        {
          "id": "src/components/AudioChat/services/ElevenLabsSessionController.js",
          "name": "ElevenLabsSessionController.js",
          "lines": 982,
          "type": "service",
          "exports": [
            "elevenLabsSessionController"
          ],
          "functions": [
            "checkResponse",
            "checkData",
            "response",
            "data",
            "AudioContext",
            "contextOptions",
            "storedCustomization",
            "requestBody",
            "response",
            "data"
          ]
        },
        {
          "id": "src/components/AudioChat/services/VoiceSessionController.js",
          "name": "VoiceSessionController.js",
          "lines": 262,
          "type": "service",
          "exports": [
            "voiceSessionController"
          ],
          "functions": [
            "voiceSessionController"
          ]
        },
        {
          "id": "src/components/AudioChat/services/aiService.js",
          "name": "aiService.js",
          "lines": 315,
          "type": "service",
          "exports": [
            "trimConversation",
            "buildConversationHistory",
            "streamAIResponse",
            "estimateTokenCount",
            "calculateConversationTokens",
            "getLengthInstruction",
            "getNSFWRoleplayInstruction"
          ],
          "functions": [
            "ESTIMATED_TOKENS_PER_WORD",
            "MAX_INPUT_TOKENS",
            "STREAMING_THROTTLE_MS",
            "createThrottle",
            "now",
            "timeSinceLastCall",
            "trimConversation",
            "trimmed",
            "msg",
            "msgTokens"
          ]
        },
        {
          "id": "src/components/AudioChat/services/commandService.js",
          "name": "commandService.js",
          "lines": 337,
          "type": "service",
          "exports": [
            "analyzeWithPointGenerator",
            "analyzeWithCommandAnalyzer",
            "getAvailableCommands",
            "applyCommandCustomizations",
            "hasNoInputCommand",
            "extractCommandIndicators",
            "removeCommandMarkers",
            "getDetectionSystem",
            "detectAndExecuteCommands"
          ],
          "functions": [
            "analyzeWithPointGenerator",
            "pg",
            "result",
            "funscriptData",
            "analyzeWithCommandAnalyzer",
            "ca",
            "result",
            "commandData",
            "getAvailableCommands",
            "buildCommandMappingFromAdapter"
          ]
        },
        {
          "id": "src/components/AudioChat/services/contentSafetyService.js",
          "name": "contentSafetyService.js",
          "lines": 78,
          "type": "service",
          "exports": [
            "getElevenLabsContentSafetyRules",
            "injectContentSafetyIfNeeded",
            "checkElevenLabsActive",
            "getContentSafetyStatus"
          ],
          "functions": [
            "getElevenLabsContentSafetyRules",
            "injectContentSafetyIfNeeded",
            "checkElevenLabsActive",
            "getContentSafetyStatus"
          ]
        },
        {
          "id": "src/components/AudioChat/services/deviceService.js",
          "name": "deviceService.js",
          "lines": 280,
          "type": "service",
          "exports": [
            "calculateFunscriptDuration",
            "executeFunscriptCommand",
            "stopDevice",
            "globalStopAllFunscripts",
            "isDeviceConnected",
            "getControllerForFirmware",
            "getHandyConnectionKey",
            "isValidFunscript",
            "parseFunscriptData",
            "getFunscriptMetadata",
            "createVisualizationData",
            "isDeviceReady",
            "getDeviceStatus"
          ],
          "functions": [
            "calculateFunscriptDuration",
            "lastAction",
            "executeFunscriptCommand",
            "stopDevice",
            "globalStopAllFunscripts",
            "isDeviceConnected",
            "getControllerForFirmware",
            "effectiveVersion",
            "versionNumber",
            "getHandyConnectionKey"
          ]
        },
        {
          "id": "src/components/AudioChat/services/enhancedConversationService.js",
          "name": "enhancedConversationService.js",
          "lines": 189,
          "type": "service",
          "exports": [
            "initializeEnhancedSession",
            "saveToEnhancedConversation",
            "getEnhancedConversation",
            "fetchFavoritePatterns",
            "selectBestConversation",
            "calculateConversationTier",
            "getTierDescription"
          ],
          "functions": [
            "initializeEnhancedSession",
            "backendURL",
            "response",
            "data",
            "saveToEnhancedConversation",
            "backendURL",
            "response",
            "data",
            "getEnhancedConversation",
            "backendURL"
          ]
        },
        {
          "id": "src/components/AudioChat/services/index.js",
          "name": "index.js",
          "lines": 15,
          "type": "service",
          "exports": [],
          "functions": []
        },
        {
          "id": "src/components/AudioChat/services/paymentService.js",
          "name": "paymentService.js",
          "lines": 320,
          "type": "service",
          "exports": [
            "calculateRemainingTime",
            "checkAccess",
            "shouldShowExtensionModal",
            "shouldPulseTimeButton",
            "unlockTime",
            "attemptAutoUnlock",
            "getRemainingFreeMessages",
            "formatRemainingTime",
            "getTimeStatus",
            "shouldDecrementFreeMessage",
            "getTimeUnlockConfig"
          ],
          "functions": [
            "calculateRemainingTime",
            "now",
            "expiryTime",
            "diffMs",
            "diffMinutes",
            "checkAccess",
            "hasAccess",
            "shouldShowExtensionModal",
            "shouldPulseTimeButton",
            "unlockTime"
          ]
        },
        {
          "id": "src/components/AudioChat/services/settingsManager.js",
          "name": "settingsManager.js",
          "lines": 199,
          "type": "service",
          "exports": [
            "settings"
          ],
          "functions": [
            "SETTINGS_DEFAULTS",
            "saved",
            "stored",
            "defaultValue",
            "settings",
            "settings",
            "eventName",
            "handler",
            "event",
            "settings"
          ]
        },
        {
          "id": "src/components/AudioChat/services/speechRecognitionService.js",
          "name": "speechRecognitionService.js",
          "lines": 195,
          "type": "service",
          "exports": [
            "getMobileInfo",
            "isMobile",
            "checkSpeechRecognitionSupport",
            "initializeSpeechRecognition",
            "setupRecognitionHandlers",
            "requestMicrophonePermission",
            "getSpeechRecognitionErrorMessage",
            "getRecognitionRestartDelay"
          ],
          "functions": [
            "getMobileInfo",
            "userAgent",
            "isMobile",
            "isIOS",
            "isChrome",
            "isSafari",
            "isFirefox",
            "isMobile",
            "checkSpeechRecognitionSupport",
            "hasWebkitSpeechRecognition"
          ]
        },
        {
          "id": "src/components/AudioChat/services/ttsService.js",
          "name": "ttsService.js",
          "lines": 258,
          "type": "service",
          "exports": [
            "playGoogleTTS",
            "stopGoogleTTS",
            "isElevenLabsActive",
            "processElevenLabsResponse",
            "stopElevenLabsTTS",
            "cleanTextForTTS",
            "splitIntoSentences",
            "getTTSProvider",
            "fetchAvailableVoices",
            "getOrCreateAudioContext",
            "resumeAudioContext",
            "requestAutoplayPermission"
          ],
          "functions": [
            "playGoogleTTS",
            "backendURL",
            "response",
            "audioBlob",
            "audioUrl",
            "audio",
            "playPromise",
            "stopGoogleTTS",
            "isElevenLabsActive",
            "processElevenLabsResponse"
          ]
        },
        {
          "id": "src/components/AudioChat/utils/index.js",
          "name": "index.js",
          "lines": 7,
          "type": "component",
          "exports": [],
          "functions": []
        },
        {
          "id": "src/components/AudioChat/utils/messageFormatting.js",
          "name": "messageFormatting.js",
          "lines": 225,
          "type": "component",
          "exports": [
            "processMessageWithCommands",
            "formatTimestamp",
            "parseMessageFormatting",
            "getMessageStats",
            "truncateText",
            "removeNarration",
            "extractDialogue",
            "isUserMessage",
            "isAssistantMessage",
            "getMessageClassName"
          ],
          "functions": [
            "processMessageWithCommands",
            "commandPattern",
            "commandIndicators",
            "commandName",
            "hasNoInput",
            "formatTimestamp",
            "date",
            "hours",
            "minutes",
            "parseMessageFormatting"
          ]
        },
        {
          "id": "src/components/Character/FunscriptController.js",
          "name": "FunscriptController.js",
          "lines": 1158,
          "type": "controller",
          "exports": [],
          "functions": [
            "newHandy",
            "connectIfNeeded",
            "startPlaybackMonitoring",
            "interval",
            "elapsed",
            "remaining",
            "handlePlaybackEnded",
            "stopPlaybackMonitoring",
            "restartCurrentFunscript",
            "restartCurrentFunscriptWithFullProcess"
          ]
        },
        {
          "id": "src/components/Character/HsspFunscriptController.js",
          "name": "HsspFunscriptController.js",
          "lines": 812,
          "type": "controller",
          "exports": [],
          "functions": [
            "effectiveFirmwareVersion",
            "isV4OrHigher",
            "isV3OrHigher",
            "newHandy",
            "connectIfNeeded",
            "calculateFunscriptDuration",
            "script",
            "metadataDuration",
            "actions",
            "lastAction"
          ]
        },
        {
          "id": "src/components/Character/StreamingFunscriptController.js",
          "name": "StreamingFunscriptController.js",
          "lines": 1922,
          "type": "controller",
          "exports": [],
          "functions": [
            "StreamingFunscriptController",
            "CHUNK_DURATION_MS",
            "CHUNK_MARGIN_MS",
            "CHUNK_SEND_INTERVAL_MS",
            "BUFFER_REPLACE_THRESHOLD_MS",
            "pendingCommandRef",
            "setPendingCommand",
            "timerGenerationRef",
            "streamingLockRef",
            "isPointGeneratorContentRef"
          ]
        },
        {
          "id": "src/pages/AdapterSettings.js",
          "name": "AdapterSettings.js",
          "lines": 1826,
          "type": "component",
          "exports": [],
          "functions": [
            "AdapterSettings",
            "navigate",
            "fileInputRefs",
            "backendURL",
            "formatRelativeTime",
            "date",
            "now",
            "diffMs",
            "diffSecs",
            "diffMins"
          ]
        },
        {
          "id": "src/components/AdapterSettings/AdapterCard.js",
          "name": "AdapterCard.js",
          "lines": 120,
          "type": "component",
          "exports": [],
          "functions": [
            "AdapterCard",
            "formatSize",
            "getStatusColor",
            "getStatusLabel"
          ]
        },
        {
          "id": "src/components/AdminComponents/CommandCollectionManager.js",
          "name": "CommandCollectionManager.js",
          "lines": 953,
          "type": "component",
          "exports": [],
          "functions": [
            "CommandCollectionManager",
            "fileInputRef",
            "funscriptInputRefs",
            "backendURL",
            "fetchCollections",
            "response",
            "data",
            "handleCreateCollection",
            "response",
            "data"
          ]
        }
      ],
      "edges": [
        {
          "from": "src/components/AudioChat/AudioChatNew.jsx",
          "to": "react-router-dom",
          "imports": [
            "useParams",
            "useNavigate"
          ]
        },
        {
          "from": "src/components/AudioChat/AudioChatNew.jsx",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/AudioChatNew.jsx",
          "to": "src/components/AudioChat/context",
          "imports": [
            "AudioChatProvider",
            "useAudioChat",
            "SpeechRecognitionProvider",
            "useSpeechRecognition",
            "TTSProvider",
            "useTTS",
            "DeviceControlProvider"
          ]
        },
        {
          "from": "src/components/AudioChat/AudioChatNew.jsx",
          "to": "src/components/AudioChat/hooks",
          "imports": [
            "useAIInference",
            "useCommandDetection",
            "useAutoContinuation",
            "usePaymentManagement",
            "useConversationInitializer"
          ]
        },
        {
          "from": "src/components/AudioChat/AudioChatNew.jsx",
          "to": "src/components/AudioChat/components/layout",
          "imports": [
            "ChatLayout"
          ]
        },
        {
          "from": "src/components/AudioChat/AudioChatNew.jsx",
          "to": "src/components/AudioChat/components/modals",
          "imports": [
            "ModalSystem"
          ]
        },
        {
          "from": "src/components/AudioChat/AudioChatNew.jsx",
          "to": "src/components/AudioChat/components/indicators/ElevenLabsIndicator.jsx",
          "imports": [
            "ElevenLabsIndicator"
          ]
        },
        {
          "from": "src/components/AudioChat/AudioChatWrapper.jsx",
          "to": "react",
          "imports": [
            "React"
          ]
        },
        {
          "from": "src/components/AudioChat/AudioChatWrapper.jsx",
          "to": "src/components/UncensoredAudio/audio_uncensored_ai.js",
          "imports": [
            "UncensoredAI_Audio"
          ]
        },
        {
          "from": "src/components/AudioChat/AudioChatWrapper.jsx",
          "to": "src/components/AudioChat/AudioChatNew.jsx",
          "imports": [
            "AudioChatNew"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/AudioChat/context/TTSProvider.jsx",
          "imports": [
            "useTTS"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/AudioChat/hooks/useVoiceChat.js",
          "imports": [
            "useVoiceChat"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/AudioChat/hooks/useAIInference.js",
          "imports": [
            "useAIInference"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/AudioChat/hooks/useAutoContinuation.js",
          "imports": [
            "useAutoContinuation"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/AudioChat/hooks/useCommandDetection.js",
          "imports": [
            "useCommandDetection"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/AudioChat/hooks/usePaymentManagement.js",
          "imports": [
            "usePaymentManagement"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/AudioChat/context/DeviceControlProvider.jsx",
          "imports": [
            "useDeviceControl"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/UncensoredAudio/UserInputSuggestions.js",
          "imports": [
            "UserInputSuggestions"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/ImageGeneration/InChatImageGenV2.js",
          "imports": [
            "InChatImageGenV2"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/UncensoredAudio/MobileTimeUnlock.js",
          "imports": [
            "MobileTimeUnlock"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "to": "src/components/UncensoredAudio/MobileNeuralToggle.js",
          "imports": [
            "MobileNeuralToggle"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatMessages.jsx",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatMessages.jsx",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/ChatMessages.jsx",
          "to": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "imports": [
            "MessageBubble"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/CommandIndicators.jsx",
          "to": "react",
          "imports": [
            "React"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/FormattedMessageText.jsx",
          "to": "src/components/AudioChat/utils/messageFormatting.js",
          "imports": [
            "parseMessageFormatting"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "to": "src/components/AudioChat/components/chat/FormattedMessageText.jsx",
          "imports": [
            "FormattedMessageText"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "to": "src/components/AudioChat/components/chat/CommandIndicators.jsx",
          "imports": [
            "CommandIndicators"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "to": "src/components/AudioChat/context/TTSProvider.jsx",
          "imports": [
            "useTTS"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "to": "src/components/AudioChat/context/DeviceControlProvider.jsx",
          "imports": [
            "useDeviceControl"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "to": "src/components/AudioChat/hooks/useAIInference.js",
          "imports": [
            "useAIInference"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "to": "src/components/AudioChat/hooks/usePaymentManagement.js",
          "imports": [
            "usePaymentManagement"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "to": "src/components/Memory/MemoryInjectionComponent.js",
          "imports": [
            "ConversationSummarizer"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/MessageBubble.jsx",
          "to": "src/components/AudioChat/utils/messageFormatting.js",
          "imports": [
            "processMessageWithCommands",
            "formatTimestamp",
            "getMessageClassName",
            "isAssistantMessage"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/TimeDisplay.jsx",
          "to": "react",
          "imports": [
            "React"
          ]
        },
        {
          "from": "src/components/AudioChat/components/chat/TimeDisplay.jsx",
          "to": "src/components/AudioChat/hooks/usePaymentManagement.js",
          "imports": [
            "usePaymentManagement"
          ]
        },
        {
          "from": "src/components/AudioChat/components/indicators/ElevenLabsIndicator.jsx",
          "to": "src/components/AudioChat/services/ElevenLabsSessionController.js",
          "imports": [
            "elevenLabsSessionController"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatLayout.jsx",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatLayout.jsx",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatLayout.jsx",
          "to": "src/components/AudioChat/hooks/useMemoryManagement.js",
          "imports": [
            "useMemoryManagement"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatLayout.jsx",
          "to": "src/components/AudioChat/hooks/usePaymentManagement.js",
          "imports": [
            "usePaymentManagement"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatLayout.jsx",
          "to": "src/components/AudioChat/context/DeviceControlProvider.jsx",
          "imports": [
            "useDeviceControl"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatLayout.jsx",
          "to": "src/components/AudioChat/components/layout/MobileHeader.jsx",
          "imports": [
            "MobileHeader"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatLayout.jsx",
          "to": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
          "imports": [
            "ChatMainContent"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatLayout.jsx",
          "to": "src/components/UncensoredAudio/RightPanel.js",
          "imports": [
            "RightPanel"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
          "to": "react",
          "imports": [
            "React"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
          "to": "src/components/AudioChat/components/chat/ChatMessages.jsx",
          "imports": [
            "ChatMessages"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
          "to": "src/components/AudioChat/components/chat/ChatInputArea.jsx",
          "imports": [
            "ChatInputArea"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
          "to": "src/components/AudioChat/components/chat/TimeDisplay.jsx",
          "imports": [
            "TimeDisplay"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
          "to": "src/components/shared/BackgroundMedia.js",
          "imports": [
            "BackgroundMedia"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
          "to": "src/components/AudioChat/context/DeviceControlProvider.jsx",
          "imports": [
            "useDeviceControl"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/ChatMainContent.jsx",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/MobileHeader.jsx",
          "to": "react-router-dom",
          "imports": [
            "useNavigate"
          ]
        },
        {
          "from": "src/components/AudioChat/components/layout/MobileHeader.jsx",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "to": "react-router-dom",
          "imports": [
            "useNavigate"
          ]
        },
        {
          "from": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "to": "src/components/AudioChat/hooks/useVoiceChat.js",
          "imports": [
            "useVoiceChat"
          ]
        },
        {
          "from": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "to": "src/components/AudioChat/hooks/usePaymentManagement.js",
          "imports": [
            "usePaymentManagement"
          ]
        },
        {
          "from": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "to": "src/components/AudioChat/hooks/useCommandDetection.js",
          "imports": [
            "useCommandDetection"
          ]
        },
        {
          "from": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "to": "src/components/AudioChat/context/SpeechRecognitionProvider.jsx",
          "imports": [
            "useSpeechRecognition"
          ]
        },
        {
          "from": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "to": "src/components/UncensoredAudio/GeminiLiveModal.js",
          "imports": [
            "GeminiLiveModal"
          ]
        },
        {
          "from": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "to": "src/components/UncensoredAudio/VoiceCallModal.js",
          "imports": [
            "VoiceCallModal"
          ]
        },
        {
          "from": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "to": "src/components/PaymentModal.js",
          "imports": [
            "PaymentModal"
          ]
        },
        {
          "from": "src/components/AudioChat/components/modals/ModalSystem.jsx",
          "to": "src/components/modals/TokensExhaustedModal.js",
          "imports": [
            "TokensExhaustedModal"
          ]
        },
        {
          "from": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "to": "src/components/AudioChat/services/settingsManager.js",
          "imports": [
            "settings"
          ]
        },
        {
          "from": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "to": "src/components/AudioChat/services/VoiceSessionController.js",
          "imports": [
            "voiceSessionController"
          ]
        },
        {
          "from": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "to": "src/components/AudioChat/services/ElevenLabsSessionController.js",
          "imports": [
            "elevenLabsSessionController"
          ]
        },
        {
          "from": "src/components/AudioChat/context/DeviceControlProvider.jsx",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/context/DeviceControlProvider.jsx",
          "to": "src/components/AudioChat/services/deviceService.js",
          "imports": [
            "calculateFunscriptDuration",
            "getControllerForFirmware",
            "isDeviceReady",
            "getDeviceStatus",
            "isValidFunscript",
            "parseFunscriptData",
            "getFunscriptMetadata"
          ]
        },
        {
          "from": "src/components/AudioChat/context/SpeechRecognitionProvider.jsx",
          "to": "src/components/AudioChat/services/speechRecognitionService.js",
          "imports": [
            "getMobileInfo",
            "checkSpeechRecognitionSupport",
            "initializeSpeechRecognition",
            "setupRecognitionHandlers",
            "getRecognitionRestartDelay"
          ]
        },
        {
          "from": "src/components/AudioChat/context/TTSProvider.jsx",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/context/TTSProvider.jsx",
          "to": "src/components/AudioChat/services/ttsService.js",
          "imports": [
            "playGoogleTTS",
            "stopGoogleTTS",
            "processElevenLabsResponse",
            "stopElevenLabsTTS",
            "isElevenLabsActive",
            "cleanTextForTTS",
            "getTTSProvider"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useAIInference.js",
          "to": "react",
          "imports": [
            "useState",
            "useCallback",
            "useRef"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useAIInference.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useAIInference.js",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useAIInference.js",
          "to": "src/components/AudioChat/hooks/useMemoryManagement.js",
          "imports": [
            "useMemoryManagement"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useAIInference.js",
          "to": "src/components/AudioChat/services/aiService.js",
          "imports": [
            "buildConversationHistory",
            "streamAIResponse",
            "getLengthInstruction",
            "getNSFWRoleplayInstruction"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useAIInference.js",
          "to": "src/components/AudioChat/services/enhancedConversationService.js",
          "imports": [
            "saveToEnhancedConversation",
            "getEnhancedConversation"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useAIInference.js",
          "to": "src/components/AudioChat/services/contentSafetyService.js",
          "imports": [
            "injectContentSafetyIfNeeded"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useAutoContinuation.js",
          "to": "react",
          "imports": [
            "useState",
            "useRef",
            "useCallback",
            "useEffect"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useAutoContinuation.js",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useCommandDetection.js",
          "to": "react",
          "imports": [
            "useState",
            "useCallback",
            "useRef"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useCommandDetection.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useCommandDetection.js",
          "to": "src/components/AudioChat/context/DeviceControlProvider.jsx",
          "imports": [
            "useDeviceControl"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useCommandDetection.js",
          "to": "src/context/TrainingDataContext.js",
          "imports": [
            "useTrainingData"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useCommandDetection.js",
          "to": "src/components/AudioChat/services/commandService.js",
          "imports": [
            "detectAndExecuteCommands",
            "hasNoInputCommand",
            "extractCommandIndicators",
            "applyCommandCustomizations",
            "getAvailableCommands"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useCommandDetection.js",
          "to": "src/components/AudioChat/services/enhancedConversationService.js",
          "imports": [
            "fetchFavoritePatterns"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useCommandDetection.js",
          "to": "src/components/SecondaryLLM/CommandAnalyzer.js",
          "imports": [
            "commandAnalyzer"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useCommandDetection.js",
          "to": "src/components/SecondaryLLM/PointGenerator.js",
          "imports": [
            "PointGenerator"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useConversationInitializer.js",
          "to": "react",
          "imports": [
            "useEffect",
            "useState",
            "useRef"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useConversationInitializer.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useConversationInitializer.js",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useConversationInitializer.js",
          "to": "src/components/AudioChat/services/enhancedConversationService.js",
          "imports": [
            "getEnhancedConversation"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useImageGeneration.js",
          "to": "react",
          "imports": [
            "useCallback"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useImageGeneration.js",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useMemoryManagement.js",
          "to": "react",
          "imports": [
            "useCallback",
            "useEffect",
            "useMemo"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useMemoryManagement.js",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useMemoryManagement.js",
          "to": "src/components/Memory/MemoryInjectionComponent.js",
          "imports": [
            "useMemoryInjection"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useMobileSpeechRecognition.js",
          "to": "react",
          "imports": [
            "useCallback",
            "useMemo"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useMobileSpeechRecognition.js",
          "to": "src/components/AudioChat/context/SpeechRecognitionProvider.jsx",
          "imports": [
            "useSpeechRecognition"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useMobileSpeechRecognition.js",
          "to": "src/components/AudioChat/services/speechRecognitionService.js",
          "imports": [
            "getSpeechRecognitionErrorMessage"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/usePaymentManagement.js",
          "to": "react",
          "imports": [
            "useState",
            "useEffect",
            "useCallback",
            "useRef"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/usePaymentManagement.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/usePaymentManagement.js",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/usePaymentManagement.js",
          "to": "src/components/AudioChat/services/paymentService.js",
          "imports": [
            "calculateRemainingTime",
            "checkAccess",
            "shouldShowExtensionModal",
            "shouldPulseTimeButton",
            "unlockTime",
            "attemptAutoUnlock",
            "getRemainingFreeMessages as getRemainingFreeMessagesUtil",
            "formatRemainingTime",
            "getTimeStatus",
            "shouldDecrementFreeMessage",
            "getTimeUnlockConfig"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useTrainingDataCollection.js",
          "to": "react",
          "imports": [
            "useCallback"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useTrainingDataCollection.js",
          "to": "src/context/TrainingDataContext.js",
          "imports": [
            "useTrainingData"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useVoiceChat.js",
          "to": "react",
          "imports": [
            "useCallback"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useVoiceChat.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useVoiceChat.js",
          "to": "src/components/AudioChat/context/AudioChatProvider.jsx",
          "imports": [
            "useAudioChat"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useVoiceChat.js",
          "to": "src/components/AudioChat/context/SpeechRecognitionProvider.jsx",
          "imports": [
            "useSpeechRecognition"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useVoiceChat.js",
          "to": "src/components/AudioChat/context/TTSProvider.jsx",
          "imports": [
            "useTTS"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useVoiceChat.js",
          "to": "src/components/AudioChat/context/DeviceControlProvider.jsx",
          "imports": [
            "useDeviceControl"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useVoiceChat.js",
          "to": "src/components/AudioChat/services/speechRecognitionService.js",
          "imports": [
            "requestMicrophonePermission"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useVoiceChat.js",
          "to": "src/components/AudioChat/services/ttsService.js",
          "imports": [
            "requestAutoplayPermission",
            "resumeAudioContext"
          ]
        },
        {
          "from": "src/components/AudioChat/hooks/useVoiceChat.js",
          "to": "src/components/AudioChat/services/ElevenLabsSessionController.js",
          "imports": [
            "elevenLabsSessionController"
          ]
        },
        {
          "from": "src/components/Character/FunscriptController.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/Character/HsspFunscriptController.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/Character/StreamingFunscriptController.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/pages/AdapterSettings.js",
          "to": "react-router-dom",
          "imports": [
            "useNavigate"
          ]
        },
        {
          "from": "src/pages/AdapterSettings.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/pages/AdapterSettings.js",
          "to": "axios",
          "imports": [
            "axios"
          ]
        },
        {
          "from": "src/pages/AdapterSettings.js",
          "to": "src/components/graphUI/FunscriptGraphViewer.js",
          "imports": [
            "FunscriptGraphViewer"
          ]
        },
        {
          "from": "src/pages/AdapterSettings.js",
          "to": "src/components/AdapterSettings/AdapterCard.js",
          "imports": [
            "AdapterCard"
          ]
        },
        {
          "from": "src/pages/AdapterSettings.js",
          "to": "src/utils/characterBackgrounds.js",
          "imports": [
            "getBlurredCharacterBackground"
          ]
        },
        {
          "from": "src/components/AdapterSettings/AdapterCard.js",
          "to": "react",
          "imports": [
            "React"
          ]
        },
        {
          "from": "src/components/AdminComponents/CommandCollectionManager.js",
          "to": "src/context/AppContext.js",
          "imports": [
            "useAppContext"
          ]
        },
        {
          "from": "src/components/AdminComponents/CommandCollectionManager.js",
          "to": "src/components/graphUI/FunscriptGraphViewer.js",
          "imports": [
            "FunscriptGraphViewer"
          ]
        }
      ]
    }
  },
  "comparison": {
    "legacy": {
      "files": 8,
      "totalLines": 10512,
      "mainFileLines": 5623,
      "testability": "Low"
    },
    "new": {
      "files": 54,
      "totalLines": 16501,
      "avgLinesPerFile": 306,
      "testability": "High",
      "byLayer": {
        "services": 12,
        "contexts": 5,
        "hooks": 11,
        "components": 23,
        "controllers": 5
      }
    }
  }
};

                setData(ARCHITECTURE_DATA);
                setLoading(false);
            }, []);

            if (loading) {
                return (
                    <div className="app">
                        <div className="header">
                            <h1>🏗️ Architecture Visualization</h1>
                        </div>
                        <div className="main-container">
                            <div className="loading">
                                <div className="loading-spinner"></div>
                                <p>Loading architecture data...</p>
                            </div>
                        </div>
                    </div>
                );
            }

            if (!data) {
                return (
                    <div className="app">
                        <div className="header">
                            <h1>🏗️ Architecture Visualization</h1>
                        </div>
                        <div className="main-container">
                            <div className="loading">
                                <p style={{color: '#EF4444'}}>Failed to load data. Make sure architecture-data.json exists.</p>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="app">
                    <div className="header">
                        <h1>🏗️ Architecture Visualization</h1>
                        <div className="view-toggle">
                            <button
                                className={view === 'legacy' ? 'active' : ''}
                                onClick={() => setView('legacy')}
                            >
                                🔴 Legacy System
                            </button>
                            <button
                                className={view === 'new' ? 'active' : ''}
                                onClick={() => setView('new')}
                            >
                                🟢 New System (V2)
                            </button>
                        </div>
                    </div>
                    <div className="main-container">
                        {view === 'legacy' ? (
                            <LegacyView
                                data={data.legacy}
                                showConnections={showConnections}
                                showUI={showUI}
                                setTooltip={setTooltip}
                            />
                        ) : (
                            <NewSystemView
                                data={data.new}
                                showConnections={showConnections}
                                showUI={showUI}
                                setTooltip={setTooltip}
                            />
                        )}
                        <div className={`mobile-toggle`} onClick={() => setShowUI(!showUI)}>
                            {showUI ? '👁️' : '📊'}
                        </div>
                        <div className={`controls ${!showUI ? 'hidden' : ''}`}>
                            <h3>⚙️ Controls</h3>
                            <p style={{fontSize: '0.85rem', marginBottom: '12px', color: 'rgba(255,255,255,0.7)'}}>
                                🖱️ Drag to rotate<br/>
                                🔍 Scroll to zoom<br/>
                                👆 Hover for details
                            </p>
                            <button
                                className={`control-button ${showConnections ? 'active' : ''}`}
                                onClick={() => setShowConnections(!showConnections)}
                            >
                                {showConnections ? '🔗 Hide Connections' : '🔗 Show Connections'}
                            </button>
                        </div>
                        {tooltip.visible && (
                            <div
                                className="tooltip visible"
                                style={{left: tooltip.x + 'px', top: tooltip.y + 'px'}}
                                dangerouslySetInnerHTML={{__html: tooltip.content}}
                            />
                        )}
                    </div>
                </div>
            );
        }

        function LegacyView({ data, showConnections, showUI, setTooltip }) {
            const canvasRef = useRef(null);
            const sceneRef = useRef(null);
            const cameraRef = useRef(null);
            const rendererRef = useRef(null);
            const controlsRef = useRef(null);
            const raycasterRef = useRef(new THREE.Raycaster());
            const mouseRef = useRef(new THREE.Vector2());
            const interactiveObjectsRef = useRef([]);

            useEffect(() => {
                if (!canvasRef.current) return;

                const canvas = canvasRef.current;
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
                const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });

                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                renderer.setClearColor(0x000000, 0);

                sceneRef.current = scene;
                cameraRef.current = camera;
                rendererRef.current = renderer;

                // Create the MAIN MONOLITH (5,623 lines)
                const monolithGeometry = new THREE.BoxGeometry(5, 7, 5);
                const monolithMaterial = new THREE.MeshPhongMaterial({
                    color: COLORS.monolith,
                    emissive: COLORS.monolith,
                    emissiveIntensity: 0.2,
                    shininess: 50,
                    transparent: true,
                    opacity: 0.7
                });
                const monolith = new THREE.Mesh(monolithGeometry, monolithMaterial);
                monolith.userData.info = `
                    <h4>📦 ${data.mainFile.name}</h4>
                    <p><strong>${data.mainFile.lines.toLocaleString()} lines</strong> of tightly coupled code</p>
                    <p class="detail">The monolith contains all logic in one massive file.</p>
                    <p class="detail">Impossible to test, maintain, or extend independently.</p>
                `;
                scene.add(monolith);

                // Add wireframe
                const edges = new THREE.EdgesGeometry(monolithGeometry);
                const wireframeMaterial = new THREE.LineBasicMaterial({ color: 0xffffff, linewidth: 2 });
                const wireframe = new THREE.LineSegments(edges, wireframeMaterial);
                monolith.add(wireframe);

                // Add CLUTTER inside monolith - many small boxes to show complexity
                const clutterCount = 40; // More boxes to show clutter
                for (let i = 0; i < clutterCount; i++) {
                    const x = (Math.random() - 0.5) * 4;
                    const y = (Math.random() - 0.5) * 6;
                    const z = (Math.random() - 0.5) * 4;

                    const size = 0.2 + Math.random() * 0.3;
                    const clutterGeometry = new THREE.BoxGeometry(size, size, size);
                    const clutterMaterial = new THREE.MeshPhongMaterial({
                        color: 0xFF6B6B,
                        emissive: 0x440000,
                        emissiveIntensity: 0.6
                    });
                    const clutterBox = new THREE.Mesh(clutterGeometry, clutterMaterial);
                    clutterBox.position.set(x, y, z);
                    clutterBox.rotation.set(
                        Math.random() * Math.PI,
                        Math.random() * Math.PI,
                        Math.random() * Math.PI
                    );
                    monolith.add(clutterBox);
                }

                // Add labeled internal systems as distinct colored boxes
                const systems = data.mainFile.systems;
                const systemRadius = 1.8;
                systems.forEach((system, i) => {
                    const angle = (i / systems.length) * Math.PI * 2;
                    const x = Math.cos(angle) * systemRadius;
                    const z = Math.sin(angle) * systemRadius;
                    const y = ((i % 3) - 1) * 1.5;

                    const systemGeometry = new THREE.BoxGeometry(0.7, 0.7, 0.7);
                    const systemMaterial = new THREE.MeshPhongMaterial({
                        color: 0xFFA500,
                        emissive: 0x664400,
                        emissiveIntensity: 0.6
                    });
                    const systemBox = new THREE.Mesh(systemGeometry, systemMaterial);
                    systemBox.position.set(x, y, z);
                    systemBox.userData.info = `
                        <h4>🔧 ${system} System</h4>
                        <p>One of the many tightly coupled systems inside the monolith</p>
                        <p class="detail">All ${systems.length} systems share state and dependencies</p>
                        <p class="detail">Changing one affects everything else</p>
                    `;
                    monolith.add(systemBox);

                    // Create angular connection lines to center
                    if (showConnections) {
                        const points = [
                            new THREE.Vector3(0, 0, 0),
                            new THREE.Vector3(x * 0.5, 0, z * 0.5),
                            new THREE.Vector3(x, y, z)
                        ];
                        const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
                        const lineMaterial = new THREE.LineBasicMaterial({
                            color: 0xFF6B6B,
                            opacity: 0.5,
                            transparent: true
                        });
                        const line = new THREE.Line(lineGeometry, lineMaterial);
                        monolith.add(line);
                    }
                });

                // Add the OTHER 7 FILES around the monolith
                const supportingFiles = data.files.slice(1); // Skip the main file
                const fileRadius = 8;
                supportingFiles.forEach((file, i) => {
                    const angle = (i / supportingFiles.length) * Math.PI * 2;
                    const x = Math.cos(angle) * fileRadius;
                    const z = Math.sin(angle) * fileRadius;
                    const y = ((i % 2) - 0.5) * 2;

                    // Size based on lines of code
                    const size = Math.min(1.5, 0.4 + (file.lines / 1000));
                    const fileGeometry = new THREE.BoxGeometry(size, size, size);
                    const fileMaterial = new THREE.MeshPhongMaterial({
                        color: 0x888888,
                        emissive: 0x333333,
                        emissiveIntensity: 0.3
                    });
                    const fileBox = new THREE.Mesh(fileGeometry, fileMaterial);
                    fileBox.position.set(x, y, z);
                    fileBox.userData.info = `
                        <h4>📄 ${file.name}</h4>
                        <p><strong>${file.lines.toLocaleString()} lines</strong></p>
                        <p class="detail">Supporting file tightly coupled to the monolith</p>
                        <p class="detail">Type: ${file.type}</p>
                    `;
                    scene.add(fileBox);

                    // Add wireframe
                    const fileEdges = new THREE.EdgesGeometry(fileGeometry);
                    const fileWireframe = new THREE.LineSegments(fileEdges, wireframeMaterial);
                    fileBox.add(fileWireframe);

                    // Connect to monolith
                    if (showConnections) {
                        const points = [
                            monolith.position.clone(),
                            new THREE.Vector3(x * 0.5, 0, z * 0.5),
                            new THREE.Vector3(x, y, z)
                        ];
                        const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
                        const lineMaterial = new THREE.LineBasicMaterial({
                            color: 0x666666,
                            opacity: 0.4,
                            transparent: true
                        });
                        const line = new THREE.Line(lineGeometry, lineMaterial);
                        scene.add(line);
                    }
                });

                // Lighting
                const light1 = new THREE.DirectionalLight(0xffffff, 1);
                light1.position.set(5, 5, 5);
                scene.add(light1);

                const light2 = new THREE.DirectionalLight(0xffffff, 0.5);
                light2.position.set(-5, -5, -5);
                scene.add(light2);

                const ambientLight = new THREE.AmbientLight(0x404040, 1);
                scene.add(ambientLight);

                camera.position.set(0, 8, 20);
                camera.lookAt(0, 0, 0);

                // Add OrbitControls
                const controls = new THREE.OrbitControls(camera, canvas);
                controls.enableDamping = true;
                controls.dampingFactor = 0.05;
                controls.minDistance = 10;
                controls.maxDistance = 50;
                controls.enablePan = true; // Allow panning
                controls.touches = { // Mobile touch controls
                    ONE: THREE.TOUCH.ROTATE,
                    TWO: THREE.TOUCH.DOLLY_PAN
                };
                controlsRef.current = controls;

                // Collect ALL interactive objects (including children of children)
                // MUST BE CALLED AFTER ALL MESHES ARE ADDED TO SCENE
                const collectInteractiveObjects = (obj, list = []) => {
                    if (obj.type === 'Mesh' && obj.userData && obj.userData.info) {
                        list.push(obj);
                    }
                    if (obj.children) {
                        obj.children.forEach(child => collectInteractiveObjects(child, list));
                    }
                    return list;
                };

                // Wait for next frame to ensure all meshes are added
                setTimeout(() => {
                    interactiveObjectsRef.current = collectInteractiveObjects(scene);
                    console.log('Legacy: Collected', interactiveObjectsRef.current.length, 'interactive objects');
                }, 0);

                // Mouse move handler for tooltips
                const handleMouseMove = (event) => {
                    const rect = canvas.getBoundingClientRect();
                    mouseRef.current.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                    mouseRef.current.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

                    raycasterRef.current.setFromCamera(mouseRef.current, camera);
                    // Raycast against ALL scene children recursively
                    const intersects = raycasterRef.current.intersectObjects(scene.children, true);

                    if (intersects.length > 0) {
                        let object = intersects[0].object;

                        // CRITICAL: Check parent mesh if we hit a wireframe/child
                        let checkObj = object;
                        let foundInfo = null;
                        while (checkObj) {
                            if (checkObj.userData && checkObj.userData.info) {
                                foundInfo = checkObj.userData.info;
                                break;
                            }
                            checkObj = checkObj.parent;
                            if (checkObj && checkObj.type === 'Scene') break;
                        }

                        if (foundInfo) {
                            setTooltip({
                                visible: true,
                                x: event.clientX + 15,
                                y: event.clientY + 15,
                                content: foundInfo
                            });
                            canvas.style.cursor = 'pointer';
                        }
                    } else {
                        setTooltip({ visible: false, x: 0, y: 0, content: null });
                        canvas.style.cursor = 'default';
                    }
                };

                // Touch handler for mobile
                const handleTouchEnd = (event) => {
                    if (event.touches.length === 0 && event.changedTouches.length === 1) {
                        const touch = event.changedTouches[0];
                        const rect = canvas.getBoundingClientRect();
                        mouseRef.current.x = ((touch.clientX - rect.left) / rect.width) * 2 - 1;
                        mouseRef.current.y = -((touch.clientY - rect.top) / rect.height) * 2 + 1;

                        raycasterRef.current.setFromCamera(mouseRef.current, camera);
                        const intersects = raycasterRef.current.intersectObjects(interactiveObjectsRef.current, true);

                        if (intersects.length > 0) {
                            let object = intersects[0].object;

                            // CRITICAL: Check parent mesh if we hit a wireframe/child
                            let checkObj = object;
                            let foundInfo = null;
                            while (checkObj) {
                                if (checkObj.userData && checkObj.userData.info) {
                                    foundInfo = checkObj.userData.info;
                                    break;
                                }
                                checkObj = checkObj.parent;
                                if (checkObj && checkObj.type === 'Scene') break;
                            }

                            if (foundInfo) {
                                setTooltip({
                                    visible: true,
                                    x: touch.clientX + 15,
                                    y: touch.clientY + 15,
                                    content: foundInfo
                                });
                                // Hide tooltip after 3 seconds on mobile
                                setTimeout(() => {
                                    setTooltip({ visible: false, x: 0, y: 0, content: null });
                                }, 3000);
                            }
                        } else {
                            setTooltip({ visible: false, x: 0, y: 0, content: null });
                        }
                    }
                };

                canvas.addEventListener('mousemove', handleMouseMove);
                canvas.addEventListener('touchend', handleTouchEnd);

                // Animation loop
                function animate() {
                    requestAnimationFrame(animate);
                    controls.update();
                    renderer.render(scene, camera);
                }
                animate();

                // Handle resize
                const handleResize = () => {
                    const width = canvas.clientWidth;
                    const height = canvas.clientHeight;
                    camera.aspect = width / height;
                    camera.updateProjectionMatrix();
                    renderer.setSize(width, height);
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    canvas.removeEventListener('mousemove', handleMouseMove);
                    canvas.removeEventListener('touchend', handleTouchEnd);
                    controls.dispose();
                };
            }, [data, showConnections, setTooltip]);

            return (
                <div className="canvas-wrapper">
                    <canvas ref={canvasRef} />
                    <div className={`info-overlay ${!showUI ? 'hidden' : ''}`}>
                        <h2>📦 Legacy System</h2>
                        <div className="stat-item">
                            <span className="stat-label">Main File</span>
                            <span className="stat-value">{data.mainFile.name}</span>
                        </div>
                        <div className="stat-item">
                            <span className="stat-label">Lines of Code</span>
                            <span className="stat-value">{data.mainFile.lines.toLocaleString()}</span>
                        </div>
                        <div className="stat-item">
                            <span className="stat-label">Total Files</span>
                            <span className="stat-value">{data.files.length}</span>
                        </div>
                        <div className="stat-item">
                            <span className="stat-label">Architecture</span>
                            <span className="stat-value">Monolithic</span>
                        </div>
                        <div className="systems-list">
                            <h3>Internal Systems</h3>
                            {data.mainFile.systems.map(system => (
                                <span key={system} className="system-tag">{system}</span>
                            ))}
                        </div>
                    </div>
                    <div className={`legend ${!showUI ? 'hidden' : ''}`}>
                        <h3>🎨 Legend</h3>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: COLOR_LABELS.monolith}}></div>
                            <span>Monolith Container</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: '#EF4444'}}></div>
                            <span>Internal Systems</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: '#888888'}}></div>
                            <span>Supporting Files</span>
                        </div>
                    </div>
                </div>
            );
        }

        function NewSystemView({ data, showConnections, showUI, setTooltip }) {
            const canvasRef = useRef(null);
            const sceneRef = useRef(null);
            const cameraRef = useRef(null);
            const rendererRef = useRef(null);
            const controlsRef = useRef(null);
            const raycasterRef = useRef(new THREE.Raycaster());
            const mouseRef = useRef(new THREE.Vector2());
            const interactiveObjectsRef = useRef([]);

            useEffect(() => {
                if (!canvasRef.current) return;

                const canvas = canvasRef.current;
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
                const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });

                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                renderer.setClearColor(0x000000, 0);

                sceneRef.current = scene;
                cameraRef.current = camera;
                rendererRef.current = renderer;

                // Define layer positions
                const layerOrder = ['services', 'contexts', 'hooks', 'components', 'controllers'];
                const layerSpacing = 3.5;
                const allNodes = [];

                layerOrder.forEach((layerName, layerIndex) => {
                    const layerFiles = data.layers[layerName] || [];
                    const layerY = (layerOrder.length / 2 - layerIndex) * layerSpacing;
                    const itemsPerRow = Math.ceil(Math.sqrt(layerFiles.length));

                    layerFiles.forEach((file, fileIndex) => {
                        const row = Math.floor(fileIndex / itemsPerRow);
                        const col = fileIndex % itemsPerRow;
                        const x = (col - itemsPerRow / 2 + 0.5) * 2;
                        const z = (row - Math.ceil(layerFiles.length / itemsPerRow) / 2 + 0.5) * 2;

                        const size = Math.min(0.8, 0.3 + (file.lines / 800));
                        const geometry = new THREE.BoxGeometry(size, size, size);
                        const color = COLORS[file.type] || COLORS.unknown;

                        const material = new THREE.MeshPhongMaterial({
                            color: color,
                            emissive: color,
                            emissiveIntensity: 0.3,
                            shininess: 50
                        });

                        const mesh = new THREE.Mesh(geometry, material);
                        mesh.position.set(x, layerY, z);

                        // Add tooltip info
                        const layerName = layerOrder[layerIndex];
                        const futureTag = file.lines === 0 ? ' <span class="badge" style="background: rgba(102,234,118,0.2); border-color: rgba(102,234,118,0.4);">Future</span>' : '';
                        mesh.userData.info = `
                            <h4>${file.name}${futureTag}</h4>
                            <p><strong>Layer:</strong> ${layerName}</p>
                            ${file.lines > 0 ? `<p><strong>${file.lines.toLocaleString()} lines</strong></p>` : '<p style="color: #66ea76;"><strong>Future Extension Point</strong></p>'}
                            <p class="detail">Type: ${file.type}</p>
                            ${file.exports && file.exports.length > 0 ? `<p class="detail">Exports: ${file.exports.slice(0, 3).join(', ')}${file.exports.length > 3 ? '...' : ''}</p>` : ''}
                        `;

                        scene.add(mesh);

                        // Add edges
                        const edges = new THREE.EdgesGeometry(geometry);
                        const edgesMaterial = new THREE.LineBasicMaterial({ color: 0xffffff, linewidth: 1 });
                        const wireframe = new THREE.LineSegments(edges, edgesMaterial);
                        mesh.add(wireframe);

                        allNodes.push({ mesh, file, layerIndex });
                    });
                });

                // Create connections between layers
                if (showConnections) {
                    for (let i = 0; i < allNodes.length; i++) {
                        const current = allNodes[i];
                        for (let j = i + 1; j < allNodes.length; j++) {
                            const next = allNodes[j];

                            // Only connect adjacent layers
                            if (Math.abs(next.layerIndex - current.layerIndex) === 1) {
                                // Random connections for visualization
                                if (Math.random() > 0.7) {
                                    const points = [
                                        current.mesh.position.clone(),
                                        new THREE.Vector3(
                                            (current.mesh.position.x + next.mesh.position.x) / 2,
                                            current.mesh.position.y,
                                            (current.mesh.position.z + next.mesh.position.z) / 2
                                        ),
                                        next.mesh.position.clone()
                                    ];

                                    const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
                                    const lineMaterial = new THREE.LineBasicMaterial({
                                        color: 0x667eea,
                                        opacity: 0.3,
                                        transparent: true
                                    });
                                    const line = new THREE.Line(lineGeometry, lineMaterial);
                                    scene.add(line);
                                }
                            }
                        }
                    }
                }

                // Lighting
                const light1 = new THREE.DirectionalLight(0xffffff, 1);
                light1.position.set(5, 5, 5);
                scene.add(light1);

                const light2 = new THREE.DirectionalLight(0xffffff, 0.5);
                light2.position.set(-5, -5, -5);
                scene.add(light2);

                const ambientLight = new THREE.AmbientLight(0x404040, 1);
                scene.add(ambientLight);

                camera.position.set(0, 6, 18);
                camera.lookAt(0, 0, 0);

                // Add OrbitControls
                const controls = new THREE.OrbitControls(camera, canvas);
                controls.enableDamping = true;
                controls.dampingFactor = 0.05;
                controls.minDistance = 10;
                controls.maxDistance = 50;
                controls.enablePan = true; // Allow panning
                controls.touches = { // Mobile touch controls
                    ONE: THREE.TOUCH.ROTATE,
                    TWO: THREE.TOUCH.DOLLY_PAN
                };
                controlsRef.current = controls;

                // Collect ALL interactive objects (including children of children)
                // MUST BE CALLED AFTER ALL MESHES ARE ADDED TO SCENE
                const collectInteractiveObjects = (obj, list = []) => {
                    if (obj.type === 'Mesh' && obj.userData && obj.userData.info) {
                        list.push(obj);
                    }
                    if (obj.children) {
                        obj.children.forEach(child => collectInteractiveObjects(child, list));
                    }
                    return list;
                };

                // Wait for next frame to ensure all meshes are added
                setTimeout(() => {
                    interactiveObjectsRef.current = collectInteractiveObjects(scene);
                    console.log('New: Collected', interactiveObjectsRef.current.length, 'interactive objects');
                }, 0);

                // Mouse move handler for tooltips
                const handleMouseMove = (event) => {
                    const rect = canvas.getBoundingClientRect();
                    mouseRef.current.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                    mouseRef.current.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

                    raycasterRef.current.setFromCamera(mouseRef.current, camera);
                    // Raycast against ALL scene children recursively
                    const intersects = raycasterRef.current.intersectObjects(scene.children, true);

                    if (intersects.length > 0) {
                        let object = intersects[0].object;

                        // CRITICAL: Check parent mesh if we hit a wireframe/child
                        let checkObj = object;
                        let foundInfo = null;
                        while (checkObj) {
                            if (checkObj.userData && checkObj.userData.info) {
                                foundInfo = checkObj.userData.info;
                                break;
                            }
                            checkObj = checkObj.parent;
                            if (checkObj && checkObj.type === 'Scene') break;
                        }

                        if (foundInfo) {
                            setTooltip({
                                visible: true,
                                x: event.clientX + 15,
                                y: event.clientY + 15,
                                content: foundInfo
                            });
                            canvas.style.cursor = 'pointer';
                        }
                    } else {
                        setTooltip({ visible: false, x: 0, y: 0, content: null });
                        canvas.style.cursor = 'default';
                    }
                };

                // Touch handler for mobile
                const handleTouchEnd = (event) => {
                    if (event.touches.length === 0 && event.changedTouches.length === 1) {
                        const touch = event.changedTouches[0];
                        const rect = canvas.getBoundingClientRect();
                        mouseRef.current.x = ((touch.clientX - rect.left) / rect.width) * 2 - 1;
                        mouseRef.current.y = -((touch.clientY - rect.top) / rect.height) * 2 + 1;

                        raycasterRef.current.setFromCamera(mouseRef.current, camera);
                        const intersects = raycasterRef.current.intersectObjects(interactiveObjectsRef.current, true);

                        if (intersects.length > 0) {
                            let object = intersects[0].object;

                            // CRITICAL: Check parent mesh if we hit a wireframe/child
                            let checkObj = object;
                            let foundInfo = null;
                            while (checkObj) {
                                if (checkObj.userData && checkObj.userData.info) {
                                    foundInfo = checkObj.userData.info;
                                    break;
                                }
                                checkObj = checkObj.parent;
                                if (checkObj && checkObj.type === 'Scene') break;
                            }

                            if (foundInfo) {
                                setTooltip({
                                    visible: true,
                                    x: touch.clientX + 15,
                                    y: touch.clientY + 15,
                                    content: foundInfo
                                });
                                // Hide tooltip after 3 seconds on mobile
                                setTimeout(() => {
                                    setTooltip({ visible: false, x: 0, y: 0, content: null });
                                }, 3000);
                            }
                        } else {
                            setTooltip({ visible: false, x: 0, y: 0, content: null });
                        }
                    }
                };

                canvas.addEventListener('mousemove', handleMouseMove);
                canvas.addEventListener('touchend', handleTouchEnd);

                // Animation loop
                function animate() {
                    requestAnimationFrame(animate);
                    controls.update();
                    renderer.render(scene, camera);
                }
                animate();

                // Handle resize
                const handleResize = () => {
                    const width = canvas.clientWidth;
                    const height = canvas.clientHeight;
                    camera.aspect = width / height;
                    camera.updateProjectionMatrix();
                    renderer.setSize(width, height);
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    canvas.removeEventListener('mousemove', handleMouseMove);
                    canvas.removeEventListener('touchend', handleTouchEnd);
                    controls.dispose();
                };
            }, [data, showConnections, setTooltip]);

            const totalFiles = Object.values(data.layers).reduce((sum, layer) => sum + layer.length, 0);

            return (
                <div className="canvas-wrapper">
                    <canvas ref={canvasRef} />
                    <div className={`info-overlay ${!showUI ? 'hidden' : ''}`}>
                        <h2>🚀 New System (V2)</h2>
                        <div className="stat-item">
                            <span className="stat-label">Architecture</span>
                            <span className="stat-value">Modular</span>
                        </div>
                        <div className="stat-item">
                            <span className="stat-label">Total Files</span>
                            <span className="stat-value">{totalFiles}</span>
                        </div>
                        <div className="stat-item">
                            <span className="stat-label">Services</span>
                            <span className="stat-value">{data.layers.services?.length || 0}</span>
                        </div>
                        <div className="stat-item">
                            <span className="stat-label">Contexts</span>
                            <span className="stat-value">{data.layers.contexts?.length || 0}</span>
                        </div>
                        <div className="stat-item">
                            <span className="stat-label">Hooks</span>
                            <span className="stat-value">{data.layers.hooks?.length || 0}</span>
                        </div>
                        <div className="stat-item">
                            <span className="stat-label">Components</span>
                            <span className="stat-value">{data.layers.components?.length || 0}</span>
                        </div>
                        <div className="stat-item">
                            <span className="stat-label">Controllers</span>
                            <span className="stat-value">{data.layers.controllers?.length || 0}</span>
                        </div>
                    </div>
                    <div className={`legend ${!showUI ? 'hidden' : ''}`}>
                        <h3>🎨 Layer Types</h3>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: COLOR_LABELS.service}}></div>
                            <span>Services</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: COLOR_LABELS.context}}></div>
                            <span>Contexts</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: COLOR_LABELS.hook}}></div>
                            <span>Hooks</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: COLOR_LABELS.component}}></div>
                            <span>Components</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{background: COLOR_LABELS.controller}}></div>
                            <span>Controllers (Devices)</span>
                        </div>
                    </div>
                    <div className={`layer-badge ${!showUI ? 'hidden' : ''}`}>
                        <div className="layer-count">5</div>
                        <div className="layer-label">Modular Layers</div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<ArchitectureApp />, document.getElementById('root'));
    </script>
</body>
</html>
